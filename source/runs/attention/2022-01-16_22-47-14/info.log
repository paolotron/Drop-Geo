2022-01-16 22:47:14   Arguments: Namespace(attention=True, augment_data=0, cache_refresh_rate=1000, colab=False, datasets_folder='../data/', device='cuda', epochs_num=20, exp_name='./runs/resize', gem_power=None, infer_batch_size=16, lr=1e-06, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, optimizer='Adam', output_folder='runs\\./runs/resize\\2022-01-16_22-47-14', patience=3, queries_per_epoch=3000, recall_values=[1, 5, 10, 20], resize=None, resume=False, seed=0, train_batch_size=2, train_positives_dist_threshold=10, val_positive_dist_threshold=25)
2022-01-16 22:47:14   The outputs are being saved in runs\./runs/resize\2022-01-16_22-47-14
2022-01-16 22:47:14   Using 1 GPUs and 8 CPUs
2022-01-16 22:47:14   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-16 22:47:15   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-16 22:47:15   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-16 22:47:15   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-16 22:47:16   Output dimension of the model is 16384
2022-01-16 22:47:16   Start training epoch: 00
2022-01-16 23:29:34   Finished epoch 00 in 0:42:17, average epoch triplet loss = 0.0838
2022-01-16 23:35:27   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 56.8, R@5: 73.9, R@10: 81.2, R@20: 87.0
2022-01-16 23:35:28   Improved: previous best R@5 = 0.0, current R@5 = 73.9
2022-01-16 23:35:28   Start training epoch: 01
2022-01-17 00:16:34   Finished epoch 01 in 0:41:06, average epoch triplet loss = 0.0816
2022-01-17 00:21:35   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 65.0, R@5: 81.9, R@10: 87.7, R@20: 91.3
2022-01-17 00:21:36   Improved: previous best R@5 = 73.9, current R@5 = 81.9
2022-01-17 00:21:36   Start training epoch: 02
2022-01-17 01:02:42   Finished epoch 02 in 0:41:06, average epoch triplet loss = 0.0800
2022-01-17 01:07:47   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 70.2, R@5: 85.8, R@10: 90.1, R@20: 93.3
2022-01-17 01:07:47   Improved: previous best R@5 = 81.9, current R@5 = 85.8
2022-01-17 01:07:47   Start training epoch: 03
2022-01-17 01:48:41   Finished epoch 03 in 0:40:54, average epoch triplet loss = 0.0797
2022-01-17 01:54:07   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 74.2, R@5: 88.0, R@10: 91.8, R@20: 94.8
2022-01-17 01:54:08   Improved: previous best R@5 = 85.8, current R@5 = 88.0
2022-01-17 01:54:08   Start training epoch: 04
2022-01-17 02:35:28   Finished epoch 04 in 0:41:20, average epoch triplet loss = 0.0782
2022-01-17 02:41:55   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 76.1, R@5: 88.9, R@10: 92.7, R@20: 95.3
2022-01-17 02:41:55   Improved: previous best R@5 = 88.0, current R@5 = 88.9
2022-01-17 02:41:55   Start training epoch: 05
2022-01-17 03:23:22   Finished epoch 05 in 0:41:27, average epoch triplet loss = 0.0773
2022-01-17 03:28:35   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 77.5, R@5: 89.7, R@10: 93.1, R@20: 95.7
2022-01-17 03:28:35   Improved: previous best R@5 = 88.9, current R@5 = 89.7
2022-01-17 03:28:35   Start training epoch: 06
2022-01-17 04:09:44   Finished epoch 06 in 0:41:08, average epoch triplet loss = 0.0776
2022-01-17 04:14:57   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 78.7, R@5: 90.4, R@10: 93.9, R@20: 96.1
2022-01-17 04:14:57   Improved: previous best R@5 = 89.7, current R@5 = 90.4
2022-01-17 04:14:57   Start training epoch: 07
2022-01-17 04:56:09   Finished epoch 07 in 0:41:11, average epoch triplet loss = 0.0765
2022-01-17 05:01:15   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.1, R@5: 90.7, R@10: 94.0, R@20: 96.0
2022-01-17 05:01:15   Improved: previous best R@5 = 90.4, current R@5 = 90.7
2022-01-17 05:01:15   Start training epoch: 08
2022-01-17 05:42:20   Finished epoch 08 in 0:41:05, average epoch triplet loss = 0.0758
2022-01-17 05:47:28   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.3, R@5: 90.9, R@10: 94.1, R@20: 96.2
2022-01-17 05:47:28   Improved: previous best R@5 = 90.7, current R@5 = 90.9
2022-01-17 05:47:28   Start training epoch: 09
2022-01-17 06:28:45   Finished epoch 09 in 0:41:16, average epoch triplet loss = 0.0750
2022-01-17 06:33:52   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.2, R@5: 91.5, R@10: 94.4, R@20: 96.3
2022-01-17 06:33:52   Improved: previous best R@5 = 90.9, current R@5 = 91.5
2022-01-17 06:33:52   Start training epoch: 10
2022-01-17 07:14:58   Finished epoch 10 in 0:41:06, average epoch triplet loss = 0.0742
2022-01-17 07:20:07   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.4, R@5: 91.9, R@10: 94.3, R@20: 96.4
2022-01-17 07:20:07   Improved: previous best R@5 = 91.5, current R@5 = 91.9
2022-01-17 07:20:07   Start training epoch: 11
2022-01-17 08:01:28   Finished epoch 11 in 0:41:21, average epoch triplet loss = 0.0748
2022-01-17 08:07:15   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.9, R@5: 91.8, R@10: 94.5, R@20: 96.4
2022-01-17 08:07:15   Not improved: 1 / 3: best R@5 = 91.9, current R@5 = 91.8
2022-01-17 08:07:15   Start training epoch: 12
2022-01-17 08:49:01   Finished epoch 12 in 0:41:45, average epoch triplet loss = 0.0732
2022-01-17 08:54:13   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.5, R@5: 92.2, R@10: 94.7, R@20: 96.5
2022-01-17 08:54:13   Improved: previous best R@5 = 91.9, current R@5 = 92.2
2022-01-17 08:54:13   Start training epoch: 13
2022-01-17 09:34:52   Finished epoch 13 in 0:40:38, average epoch triplet loss = 0.0731
2022-01-17 09:39:59   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.0, R@5: 92.5, R@10: 94.9, R@20: 96.6
2022-01-17 09:39:59   Improved: previous best R@5 = 92.2, current R@5 = 92.5
2022-01-17 09:39:59   Start training epoch: 14
2022-01-17 10:21:28   Finished epoch 14 in 0:41:28, average epoch triplet loss = 0.0721
2022-01-17 10:26:43   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.8, R@5: 92.7, R@10: 95.1, R@20: 96.7
2022-01-17 10:26:43   Improved: previous best R@5 = 92.5, current R@5 = 92.7
2022-01-17 10:26:43   Start training epoch: 15
2022-01-17 11:08:23   Finished epoch 15 in 0:41:39, average epoch triplet loss = 0.0723
2022-01-17 11:13:30   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.8, R@5: 92.7, R@10: 95.0, R@20: 96.8
2022-01-17 11:13:30   Not improved: 1 / 3: best R@5 = 92.7, current R@5 = 92.7
2022-01-17 11:13:30   Start training epoch: 16
2022-01-17 11:55:22   Finished epoch 16 in 0:41:51, average epoch triplet loss = 0.0712
2022-01-17 12:01:10   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.5, R@5: 92.5, R@10: 95.0, R@20: 96.8
2022-01-17 12:01:10   Not improved: 2 / 3: best R@5 = 92.7, current R@5 = 92.5
2022-01-17 12:01:10   Start training epoch: 17
2022-01-17 12:44:18   Finished epoch 17 in 0:43:07, average epoch triplet loss = 0.0699
2022-01-17 12:49:12   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 83.2, R@5: 92.7, R@10: 95.1, R@20: 96.7
2022-01-17 12:49:12   Not improved: 3 / 3: best R@5 = 92.7, current R@5 = 92.7
2022-01-17 12:49:12   Performance did not improve for 3 epochs. Stop training.
2022-01-17 12:49:12   Best R@5: 92.7
2022-01-17 12:49:12   Trained for 19 epochs, in total in 14:01:58
2022-01-17 12:54:32   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 81.5, R@5: 91.2, R@10: 93.6, R@20: 95.5
