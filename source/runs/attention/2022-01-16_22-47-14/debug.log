2022-01-16 22:47:14   Arguments: Namespace(attention=True, augment_data=0, cache_refresh_rate=1000, colab=False, datasets_folder='../data/', device='cuda', epochs_num=20, exp_name='./runs/resize', gem_power=None, infer_batch_size=16, lr=1e-06, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, optimizer='Adam', output_folder='runs\\./runs/resize\\2022-01-16_22-47-14', patience=3, queries_per_epoch=3000, recall_values=[1, 5, 10, 20], resize=None, resume=False, seed=0, train_batch_size=2, train_positives_dist_threshold=10, val_positive_dist_threshold=25)
2022-01-16 22:47:14   The outputs are being saved in runs\./runs/resize\2022-01-16_22-47-14
2022-01-16 22:47:14   Using 1 GPUs and 8 CPUs
2022-01-16 22:47:14   Loading dataset Pitts30k from folder ../data/
2022-01-16 22:47:14   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-16 22:47:15   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-16 22:47:15   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-16 22:47:15   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-16 22:47:16   Output dimension of the model is 16384
2022-01-16 22:47:16   Start training epoch: 00
2022-01-16 22:47:16   Cache: 0 / 3
2022-01-16 23:01:47   Epoch[00](0/3): current batch triplet loss = 0.0661, average epoch triplet loss = 0.0841
2022-01-16 23:01:47   Cache: 1 / 3
2022-01-16 23:15:55   Epoch[00](1/3): current batch triplet loss = 0.1040, average epoch triplet loss = 0.0843
2022-01-16 23:15:55   Cache: 2 / 3
2022-01-16 23:29:34   Epoch[00](2/3): current batch triplet loss = 0.0902, average epoch triplet loss = 0.0838
2022-01-16 23:29:34   Finished epoch 00 in 0:42:17, average epoch triplet loss = 0.0838
2022-01-16 23:29:34   Extracting database features for evaluation/testing
2022-01-16 23:32:22   Extracting queries features for evaluation/testing
2022-01-16 23:34:58   Calculating recalls
2022-01-16 23:35:27   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 56.8, R@5: 73.9, R@10: 81.2, R@20: 87.0
2022-01-16 23:35:28   Improved: previous best R@5 = 0.0, current R@5 = 73.9
2022-01-16 23:35:28   Start training epoch: 01
2022-01-16 23:35:28   Cache: 0 / 3
2022-01-16 23:49:20   Epoch[01](0/3): current batch triplet loss = 0.0942, average epoch triplet loss = 0.0826
2022-01-16 23:49:20   Cache: 1 / 3
2022-01-17 00:03:01   Epoch[01](1/3): current batch triplet loss = 0.0840, average epoch triplet loss = 0.0822
2022-01-17 00:03:01   Cache: 2 / 3
2022-01-17 00:16:34   Epoch[01](2/3): current batch triplet loss = 0.0956, average epoch triplet loss = 0.0816
2022-01-17 00:16:34   Finished epoch 01 in 0:41:06, average epoch triplet loss = 0.0816
2022-01-17 00:16:34   Extracting database features for evaluation/testing
2022-01-17 00:19:03   Extracting queries features for evaluation/testing
2022-01-17 00:21:05   Calculating recalls
2022-01-17 00:21:35   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 65.0, R@5: 81.9, R@10: 87.7, R@20: 91.3
2022-01-17 00:21:36   Improved: previous best R@5 = 73.9, current R@5 = 81.9
2022-01-17 00:21:36   Start training epoch: 02
2022-01-17 00:21:36   Cache: 0 / 3
2022-01-17 00:35:40   Epoch[02](0/3): current batch triplet loss = 0.0919, average epoch triplet loss = 0.0801
2022-01-17 00:35:40   Cache: 1 / 3
2022-01-17 00:49:14   Epoch[02](1/3): current batch triplet loss = 0.0898, average epoch triplet loss = 0.0801
2022-01-17 00:49:14   Cache: 2 / 3
2022-01-17 01:02:42   Epoch[02](2/3): current batch triplet loss = 0.0838, average epoch triplet loss = 0.0800
2022-01-17 01:02:42   Finished epoch 02 in 0:41:06, average epoch triplet loss = 0.0800
2022-01-17 01:02:42   Extracting database features for evaluation/testing
2022-01-17 01:05:12   Extracting queries features for evaluation/testing
2022-01-17 01:07:17   Calculating recalls
2022-01-17 01:07:47   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 70.2, R@5: 85.8, R@10: 90.1, R@20: 93.3
2022-01-17 01:07:47   Improved: previous best R@5 = 81.9, current R@5 = 85.8
2022-01-17 01:07:47   Start training epoch: 03
2022-01-17 01:07:47   Cache: 0 / 3
2022-01-17 01:21:45   Epoch[03](0/3): current batch triplet loss = 0.0885, average epoch triplet loss = 0.0799
2022-01-17 01:21:45   Cache: 1 / 3
2022-01-17 01:35:16   Epoch[03](1/3): current batch triplet loss = 0.0841, average epoch triplet loss = 0.0796
2022-01-17 01:35:16   Cache: 2 / 3
2022-01-17 01:48:41   Epoch[03](2/3): current batch triplet loss = 0.0878, average epoch triplet loss = 0.0797
2022-01-17 01:48:41   Finished epoch 03 in 0:40:54, average epoch triplet loss = 0.0797
2022-01-17 01:48:41   Extracting database features for evaluation/testing
2022-01-17 01:51:21   Extracting queries features for evaluation/testing
2022-01-17 01:53:33   Calculating recalls
2022-01-17 01:54:07   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 74.2, R@5: 88.0, R@10: 91.8, R@20: 94.8
2022-01-17 01:54:08   Improved: previous best R@5 = 85.8, current R@5 = 88.0
2022-01-17 01:54:08   Start training epoch: 04
2022-01-17 01:54:08   Cache: 0 / 3
2022-01-17 02:07:44   Epoch[04](0/3): current batch triplet loss = 0.0516, average epoch triplet loss = 0.0788
2022-01-17 02:07:44   Cache: 1 / 3
2022-01-17 02:21:38   Epoch[04](1/3): current batch triplet loss = 0.0491, average epoch triplet loss = 0.0782
2022-01-17 02:21:38   Cache: 2 / 3
2022-01-17 02:35:28   Epoch[04](2/3): current batch triplet loss = 0.0747, average epoch triplet loss = 0.0782
2022-01-17 02:35:28   Finished epoch 04 in 0:41:20, average epoch triplet loss = 0.0782
2022-01-17 02:35:28   Extracting database features for evaluation/testing
2022-01-17 02:38:46   Extracting queries features for evaluation/testing
2022-01-17 02:41:19   Calculating recalls
2022-01-17 02:41:55   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 76.1, R@5: 88.9, R@10: 92.7, R@20: 95.3
2022-01-17 02:41:55   Improved: previous best R@5 = 88.0, current R@5 = 88.9
2022-01-17 02:41:55   Start training epoch: 05
2022-01-17 02:41:55   Cache: 0 / 3
2022-01-17 02:55:48   Epoch[05](0/3): current batch triplet loss = 0.0803, average epoch triplet loss = 0.0761
2022-01-17 02:55:48   Cache: 1 / 3
2022-01-17 03:09:40   Epoch[05](1/3): current batch triplet loss = 0.0781, average epoch triplet loss = 0.0770
2022-01-17 03:09:40   Cache: 2 / 3
2022-01-17 03:23:22   Epoch[05](2/3): current batch triplet loss = 0.0374, average epoch triplet loss = 0.0773
2022-01-17 03:23:22   Finished epoch 05 in 0:41:27, average epoch triplet loss = 0.0773
2022-01-17 03:23:22   Extracting database features for evaluation/testing
2022-01-17 03:25:58   Extracting queries features for evaluation/testing
2022-01-17 03:28:00   Calculating recalls
2022-01-17 03:28:35   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 77.5, R@5: 89.7, R@10: 93.1, R@20: 95.7
2022-01-17 03:28:35   Improved: previous best R@5 = 88.9, current R@5 = 89.7
2022-01-17 03:28:35   Start training epoch: 06
2022-01-17 03:28:35   Cache: 0 / 3
2022-01-17 03:42:21   Epoch[06](0/3): current batch triplet loss = 0.0992, average epoch triplet loss = 0.0773
2022-01-17 03:42:21   Cache: 1 / 3
2022-01-17 03:56:01   Epoch[06](1/3): current batch triplet loss = 0.0938, average epoch triplet loss = 0.0774
2022-01-17 03:56:01   Cache: 2 / 3
2022-01-17 04:09:44   Epoch[06](2/3): current batch triplet loss = 0.0768, average epoch triplet loss = 0.0776
2022-01-17 04:09:44   Finished epoch 06 in 0:41:08, average epoch triplet loss = 0.0776
2022-01-17 04:09:44   Extracting database features for evaluation/testing
2022-01-17 04:12:12   Extracting queries features for evaluation/testing
2022-01-17 04:14:22   Calculating recalls
2022-01-17 04:14:57   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 78.7, R@5: 90.4, R@10: 93.9, R@20: 96.1
2022-01-17 04:14:57   Improved: previous best R@5 = 89.7, current R@5 = 90.4
2022-01-17 04:14:57   Start training epoch: 07
2022-01-17 04:14:57   Cache: 0 / 3
2022-01-17 04:28:44   Epoch[07](0/3): current batch triplet loss = 0.0951, average epoch triplet loss = 0.0758
2022-01-17 04:28:44   Cache: 1 / 3
2022-01-17 04:42:26   Epoch[07](1/3): current batch triplet loss = 0.0850, average epoch triplet loss = 0.0765
2022-01-17 04:42:26   Cache: 2 / 3
2022-01-17 04:56:09   Epoch[07](2/3): current batch triplet loss = 0.0731, average epoch triplet loss = 0.0765
2022-01-17 04:56:09   Finished epoch 07 in 0:41:11, average epoch triplet loss = 0.0765
2022-01-17 04:56:09   Extracting database features for evaluation/testing
2022-01-17 04:58:36   Extracting queries features for evaluation/testing
2022-01-17 05:00:40   Calculating recalls
2022-01-17 05:01:15   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.1, R@5: 90.7, R@10: 94.0, R@20: 96.0
2022-01-17 05:01:15   Improved: previous best R@5 = 90.4, current R@5 = 90.7
2022-01-17 05:01:15   Start training epoch: 08
2022-01-17 05:01:15   Cache: 0 / 3
2022-01-17 05:15:02   Epoch[08](0/3): current batch triplet loss = 0.0834, average epoch triplet loss = 0.0764
2022-01-17 05:15:02   Cache: 1 / 3
2022-01-17 05:28:42   Epoch[08](1/3): current batch triplet loss = 0.0496, average epoch triplet loss = 0.0763
2022-01-17 05:28:42   Cache: 2 / 3
2022-01-17 05:42:20   Epoch[08](2/3): current batch triplet loss = 0.0469, average epoch triplet loss = 0.0758
2022-01-17 05:42:20   Finished epoch 08 in 0:41:05, average epoch triplet loss = 0.0758
2022-01-17 05:42:20   Extracting database features for evaluation/testing
2022-01-17 05:44:48   Extracting queries features for evaluation/testing
2022-01-17 05:46:53   Calculating recalls
2022-01-17 05:47:28   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.3, R@5: 90.9, R@10: 94.1, R@20: 96.2
2022-01-17 05:47:28   Improved: previous best R@5 = 90.7, current R@5 = 90.9
2022-01-17 05:47:28   Start training epoch: 09
2022-01-17 05:47:28   Cache: 0 / 3
2022-01-17 06:01:21   Epoch[09](0/3): current batch triplet loss = 0.0649, average epoch triplet loss = 0.0756
2022-01-17 06:01:21   Cache: 1 / 3
2022-01-17 06:15:04   Epoch[09](1/3): current batch triplet loss = 0.0197, average epoch triplet loss = 0.0749
2022-01-17 06:15:04   Cache: 2 / 3
2022-01-17 06:28:45   Epoch[09](2/3): current batch triplet loss = 0.0580, average epoch triplet loss = 0.0750
2022-01-17 06:28:45   Finished epoch 09 in 0:41:16, average epoch triplet loss = 0.0750
2022-01-17 06:28:45   Extracting database features for evaluation/testing
2022-01-17 06:31:12   Extracting queries features for evaluation/testing
2022-01-17 06:33:17   Calculating recalls
2022-01-17 06:33:52   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.2, R@5: 91.5, R@10: 94.4, R@20: 96.3
2022-01-17 06:33:52   Improved: previous best R@5 = 90.9, current R@5 = 91.5
2022-01-17 06:33:52   Start training epoch: 10
2022-01-17 06:33:52   Cache: 0 / 3
2022-01-17 06:47:35   Epoch[10](0/3): current batch triplet loss = 0.0784, average epoch triplet loss = 0.0751
2022-01-17 06:47:35   Cache: 1 / 3
2022-01-17 07:01:15   Epoch[10](1/3): current batch triplet loss = 0.0743, average epoch triplet loss = 0.0747
2022-01-17 07:01:15   Cache: 2 / 3
2022-01-17 07:14:58   Epoch[10](2/3): current batch triplet loss = 0.0409, average epoch triplet loss = 0.0742
2022-01-17 07:14:58   Finished epoch 10 in 0:41:06, average epoch triplet loss = 0.0742
2022-01-17 07:14:58   Extracting database features for evaluation/testing
2022-01-17 07:17:26   Extracting queries features for evaluation/testing
2022-01-17 07:19:32   Calculating recalls
2022-01-17 07:20:07   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.4, R@5: 91.9, R@10: 94.3, R@20: 96.4
2022-01-17 07:20:07   Improved: previous best R@5 = 91.5, current R@5 = 91.9
2022-01-17 07:20:07   Start training epoch: 11
2022-01-17 07:20:07   Cache: 0 / 3
2022-01-17 07:33:55   Epoch[11](0/3): current batch triplet loss = 0.0994, average epoch triplet loss = 0.0752
2022-01-17 07:33:55   Cache: 1 / 3
2022-01-17 07:47:38   Epoch[11](1/3): current batch triplet loss = 0.0555, average epoch triplet loss = 0.0747
2022-01-17 07:47:38   Cache: 2 / 3
2022-01-17 08:01:28   Epoch[11](2/3): current batch triplet loss = 0.0785, average epoch triplet loss = 0.0748
2022-01-17 08:01:28   Finished epoch 11 in 0:41:21, average epoch triplet loss = 0.0748
2022-01-17 08:01:28   Extracting database features for evaluation/testing
2022-01-17 08:04:12   Extracting queries features for evaluation/testing
2022-01-17 08:06:40   Calculating recalls
2022-01-17 08:07:15   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.9, R@5: 91.8, R@10: 94.5, R@20: 96.4
2022-01-17 08:07:15   Not improved: 1 / 3: best R@5 = 91.9, current R@5 = 91.8
2022-01-17 08:07:15   Start training epoch: 12
2022-01-17 08:07:15   Cache: 0 / 3
2022-01-17 08:21:28   Epoch[12](0/3): current batch triplet loss = 0.0773, average epoch triplet loss = 0.0715
2022-01-17 08:21:28   Cache: 1 / 3
2022-01-17 08:35:17   Epoch[12](1/3): current batch triplet loss = 0.0865, average epoch triplet loss = 0.0724
2022-01-17 08:35:17   Cache: 2 / 3
2022-01-17 08:49:01   Epoch[12](2/3): current batch triplet loss = 0.0749, average epoch triplet loss = 0.0732
2022-01-17 08:49:01   Finished epoch 12 in 0:41:45, average epoch triplet loss = 0.0732
2022-01-17 08:49:01   Extracting database features for evaluation/testing
2022-01-17 08:51:33   Extracting queries features for evaluation/testing
2022-01-17 08:53:42   Calculating recalls
2022-01-17 08:54:13   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.5, R@5: 92.2, R@10: 94.7, R@20: 96.5
2022-01-17 08:54:13   Improved: previous best R@5 = 91.9, current R@5 = 92.2
2022-01-17 08:54:13   Start training epoch: 13
2022-01-17 08:54:13   Cache: 0 / 3
2022-01-17 09:07:37   Epoch[13](0/3): current batch triplet loss = 0.0614, average epoch triplet loss = 0.0728
2022-01-17 09:07:37   Cache: 1 / 3
2022-01-17 09:21:05   Epoch[13](1/3): current batch triplet loss = 0.0756, average epoch triplet loss = 0.0732
2022-01-17 09:21:05   Cache: 2 / 3
2022-01-17 09:34:52   Epoch[13](2/3): current batch triplet loss = 0.0898, average epoch triplet loss = 0.0731
2022-01-17 09:34:52   Finished epoch 13 in 0:40:38, average epoch triplet loss = 0.0731
2022-01-17 09:34:52   Extracting database features for evaluation/testing
2022-01-17 09:37:20   Extracting queries features for evaluation/testing
2022-01-17 09:39:23   Calculating recalls
2022-01-17 09:39:59   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.0, R@5: 92.5, R@10: 94.9, R@20: 96.6
2022-01-17 09:39:59   Improved: previous best R@5 = 92.2, current R@5 = 92.5
2022-01-17 09:39:59   Start training epoch: 14
2022-01-17 09:39:59   Cache: 0 / 3
2022-01-17 09:53:48   Epoch[14](0/3): current batch triplet loss = 0.0551, average epoch triplet loss = 0.0734
2022-01-17 09:53:48   Cache: 1 / 3
2022-01-17 10:07:34   Epoch[14](1/3): current batch triplet loss = 0.0983, average epoch triplet loss = 0.0722
2022-01-17 10:07:34   Cache: 2 / 3
2022-01-17 10:21:28   Epoch[14](2/3): current batch triplet loss = 0.0642, average epoch triplet loss = 0.0721
2022-01-17 10:21:28   Finished epoch 14 in 0:41:28, average epoch triplet loss = 0.0721
2022-01-17 10:21:28   Extracting database features for evaluation/testing
2022-01-17 10:23:57   Extracting queries features for evaluation/testing
2022-01-17 10:26:08   Calculating recalls
2022-01-17 10:26:43   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.8, R@5: 92.7, R@10: 95.1, R@20: 96.7
2022-01-17 10:26:43   Improved: previous best R@5 = 92.5, current R@5 = 92.7
2022-01-17 10:26:43   Start training epoch: 15
2022-01-17 10:26:43   Cache: 0 / 3
2022-01-17 10:40:38   Epoch[15](0/3): current batch triplet loss = 0.0901, average epoch triplet loss = 0.0730
2022-01-17 10:40:38   Cache: 1 / 3
2022-01-17 10:54:35   Epoch[15](1/3): current batch triplet loss = 0.0619, average epoch triplet loss = 0.0722
2022-01-17 10:54:35   Cache: 2 / 3
2022-01-17 11:08:23   Epoch[15](2/3): current batch triplet loss = 0.0730, average epoch triplet loss = 0.0723
2022-01-17 11:08:23   Finished epoch 15 in 0:41:39, average epoch triplet loss = 0.0723
2022-01-17 11:08:23   Extracting database features for evaluation/testing
2022-01-17 11:10:50   Extracting queries features for evaluation/testing
2022-01-17 11:12:56   Calculating recalls
2022-01-17 11:13:30   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.8, R@5: 92.7, R@10: 95.0, R@20: 96.8
2022-01-17 11:13:30   Not improved: 1 / 3: best R@5 = 92.7, current R@5 = 92.7
2022-01-17 11:13:30   Start training epoch: 16
2022-01-17 11:13:30   Cache: 0 / 3
2022-01-17 11:27:11   Epoch[16](0/3): current batch triplet loss = 0.0414, average epoch triplet loss = 0.0714
2022-01-17 11:27:11   Cache: 1 / 3
2022-01-17 11:40:47   Epoch[16](1/3): current batch triplet loss = 0.0721, average epoch triplet loss = 0.0714
2022-01-17 11:40:47   Cache: 2 / 3
2022-01-17 11:55:22   Epoch[16](2/3): current batch triplet loss = 0.0701, average epoch triplet loss = 0.0712
2022-01-17 11:55:22   Finished epoch 16 in 0:41:51, average epoch triplet loss = 0.0712
2022-01-17 11:55:22   Extracting database features for evaluation/testing
2022-01-17 11:58:14   Extracting queries features for evaluation/testing
2022-01-17 12:00:33   Calculating recalls
2022-01-17 12:01:10   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.5, R@5: 92.5, R@10: 95.0, R@20: 96.8
2022-01-17 12:01:10   Not improved: 2 / 3: best R@5 = 92.7, current R@5 = 92.5
2022-01-17 12:01:10   Start training epoch: 17
2022-01-17 12:01:10   Cache: 0 / 3
2022-01-17 12:15:23   Epoch[17](0/3): current batch triplet loss = 0.1126, average epoch triplet loss = 0.0701
2022-01-17 12:15:23   Cache: 1 / 3
2022-01-17 12:29:54   Epoch[17](1/3): current batch triplet loss = 0.0922, average epoch triplet loss = 0.0698
2022-01-17 12:29:54   Cache: 2 / 3
2022-01-17 12:44:18   Epoch[17](2/3): current batch triplet loss = 0.0636, average epoch triplet loss = 0.0699
2022-01-17 12:44:18   Finished epoch 17 in 0:43:07, average epoch triplet loss = 0.0699
2022-01-17 12:44:18   Extracting database features for evaluation/testing
2022-01-17 12:46:45   Extracting queries features for evaluation/testing
2022-01-17 12:48:41   Calculating recalls
2022-01-17 12:49:12   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 83.2, R@5: 92.7, R@10: 95.1, R@20: 96.7
2022-01-17 12:49:12   Not improved: 3 / 3: best R@5 = 92.7, current R@5 = 92.7
2022-01-17 12:49:12   Performance did not improve for 3 epochs. Stop training.
2022-01-17 12:49:12   Best R@5: 92.7
2022-01-17 12:49:12   Trained for 19 epochs, in total in 14:01:58
2022-01-17 12:49:13   Extracting database features for evaluation/testing
2022-01-17 12:52:05   Extracting queries features for evaluation/testing
2022-01-17 12:54:05   Calculating recalls
2022-01-17 12:54:32   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 81.5, R@5: 91.2, R@10: 93.6, R@20: 95.5
