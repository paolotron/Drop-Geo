2022-01-17 11:08:10   Arguments: Namespace(attention=False, augment_data=0, cache_refresh_rate=1000, colab=True, datasets_folder='Drop-Geo/dataset/', device='cuda', epochs_num=20, exp_name='distance_train', gem_power=None, infer_batch_size=16, lr=0.0001, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=2, optimizer='Adam', output_folder='Drop-Geo/source/runs/distance_train/2022-01-17_11-08-10', patience=3, queries_per_epoch=3000, recall_values=[1, 5, 10, 20], resize=None, resume=False, seed=0, train_batch_size=2, train_positives_dist_threshold=15, val_positive_dist_threshold=25)
2022-01-17 11:08:10   The outputs are being saved in Drop-Geo/source/runs/distance_train/2022-01-17_11-08-10
2022-01-17 11:08:10   Using 1 GPUs and 2 CPUs
2022-01-17 11:08:10   There are 48 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-17 11:08:11   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7368 >
2022-01-17 11:08:11   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-17 11:08:11   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-17 11:08:15   Output dimension of the model is 16384
2022-01-17 11:08:15   Start training epoch: 00
2022-01-17 11:27:46   Finished epoch 00 in 0:19:31, average epoch triplet loss = 0.0355
2022-01-17 11:31:51   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.3, R@5: 90.8, R@10: 93.5, R@20: 95.7
2022-01-17 11:31:51   Improved: previous best R@5 = 0.0, current R@5 = 90.8
2022-01-17 11:31:51   Refreshing access_token
2022-01-17 11:31:51   file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
2022-01-17 11:31:55   Start training epoch: 01
2022-01-17 11:53:38   Finished epoch 01 in 0:21:43, average epoch triplet loss = 0.0153
2022-01-17 11:57:40   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.1, R@5: 91.6, R@10: 94.1, R@20: 96.1
2022-01-17 11:57:40   Improved: previous best R@5 = 90.8, current R@5 = 91.6
2022-01-17 11:57:40   Refreshing access_token
2022-01-17 11:57:44   Start training epoch: 02
2022-01-17 12:17:36   Finished epoch 02 in 0:19:51, average epoch triplet loss = 0.0099
2022-01-17 12:21:42   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.5, R@5: 90.8, R@10: 92.9, R@20: 95.3
2022-01-17 12:21:42   Not improved: 1 / 3: best R@5 = 91.6, current R@5 = 90.8
2022-01-17 12:21:42   Refreshing access_token
2022-01-17 12:21:46   Start training epoch: 03
2022-01-17 12:41:43   Finished epoch 03 in 0:19:57, average epoch triplet loss = 0.0072
2022-01-17 12:45:49   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.1, R@5: 91.7, R@10: 94.5, R@20: 96.3
2022-01-17 12:45:49   Improved: previous best R@5 = 91.6, current R@5 = 91.7
2022-01-17 12:45:49   Refreshing access_token
2022-01-17 12:45:53   Start training epoch: 04
2022-01-17 13:05:53   Finished epoch 04 in 0:19:59, average epoch triplet loss = 0.0063
2022-01-17 13:09:57   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 83.6, R@5: 92.3, R@10: 94.4, R@20: 96.3
2022-01-17 13:09:58   Improved: previous best R@5 = 91.7, current R@5 = 92.3
2022-01-17 13:09:58   Refreshing access_token
2022-01-17 13:10:02   Start training epoch: 05
2022-01-17 13:29:55   Finished epoch 05 in 0:19:53, average epoch triplet loss = 0.0059
2022-01-17 13:33:59   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 83.2, R@5: 92.2, R@10: 94.5, R@20: 96.0
2022-01-17 13:34:00   Not improved: 1 / 3: best R@5 = 92.3, current R@5 = 92.2
2022-01-17 13:34:00   Refreshing access_token
2022-01-17 13:34:04   Start training epoch: 06
2022-01-17 13:53:59   Finished epoch 06 in 0:19:55, average epoch triplet loss = 0.0053
2022-01-17 13:58:03   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 83.8, R@5: 93.0, R@10: 95.2, R@20: 97.0
2022-01-17 13:58:03   Improved: previous best R@5 = 92.3, current R@5 = 93.0
2022-01-17 13:58:03   Refreshing access_token
2022-01-17 13:58:07   Start training epoch: 07
2022-01-17 14:18:00   Finished epoch 07 in 0:19:52, average epoch triplet loss = 0.0049
2022-01-17 14:22:04   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.0, R@5: 91.6, R@10: 94.5, R@20: 96.4
2022-01-17 14:22:04   Not improved: 1 / 3: best R@5 = 93.0, current R@5 = 91.6
2022-01-17 14:22:04   Refreshing access_token
2022-01-17 14:22:08   Start training epoch: 08
2022-01-17 14:42:08   Finished epoch 08 in 0:19:59, average epoch triplet loss = 0.0050
2022-01-17 14:46:11   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 84.5, R@5: 93.0, R@10: 95.1, R@20: 97.0
2022-01-17 14:46:11   Not improved: 2 / 3: best R@5 = 93.0, current R@5 = 93.0
2022-01-17 14:46:11   Refreshing access_token
2022-01-17 14:46:16   Start training epoch: 09
2022-01-17 15:06:29   Finished epoch 09 in 0:20:13, average epoch triplet loss = 0.0052
2022-01-17 15:10:34   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.6, R@5: 92.2, R@10: 94.9, R@20: 96.6
2022-01-17 15:10:35   Not improved: 3 / 3: best R@5 = 93.0, current R@5 = 92.2
2022-01-17 15:10:35   Performance did not improve for 3 epochs. Stop training.
2022-01-17 15:10:35   Best R@5: 93.0
2022-01-17 15:10:35   Trained for 11 epochs, in total in 4:02:24
2022-01-17 15:14:28   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 81.6, R@5: 91.1, R@10: 93.4, R@20: 95.3
