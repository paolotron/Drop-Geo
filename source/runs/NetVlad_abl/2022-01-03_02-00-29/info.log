2022-01-03 02:00:29   Arguments: Namespace(cache_refresh_rate=1000, datasets_folder='../data/', device='cuda', epochs_num=20, exp_name='./runs/NetVlad_abl', gem_power=None, infer_batch_size=16, lr=1e-05, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, output_folder='runs/./runs/NetVlad_abl/2022-01-03_02-00-29', patience=3, queries_per_epoch=3000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=2, train_positives_dist_threshold=10, val_positive_dist_threshold=25)
2022-01-03 02:00:29   The outputs are being saved in runs/./runs/NetVlad_abl/2022-01-03_02-00-29
2022-01-03 02:00:30   Using 1 GPUs and 8 CPUs
2022-01-03 02:00:30   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-03 02:00:30   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-03 02:00:30   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-03 02:00:30   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-03 02:00:35   Output dimension of the model is 16384
2022-01-03 02:00:35   Start training epoch: 00
2022-01-03 02:42:19   Finished epoch 00 in 0:41:44, average epoch triplet loss = 0.0985
2022-01-03 02:48:47   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 12.6, R@5: 28.8, R@10: 40.4, R@20: 54.2
2022-01-03 02:48:47   Improved: previous best R@5 = 0.0, current R@5 = 28.8
2022-01-03 02:48:47   Start training epoch: 01
2022-01-03 03:29:57   Finished epoch 01 in 0:41:09, average epoch triplet loss = 0.0991
2022-01-03 03:36:24   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 14.5, R@5: 32.8, R@10: 43.8, R@20: 57.1
2022-01-03 03:36:24   Improved: previous best R@5 = 28.8, current R@5 = 32.8
2022-01-03 03:36:24   Start training epoch: 02
2022-01-03 04:17:34   Finished epoch 02 in 0:41:10, average epoch triplet loss = 0.0987
2022-01-03 04:24:00   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 13.6, R@5: 30.7, R@10: 43.3, R@20: 58.4
2022-01-03 04:24:00   Not improved: 1 / 3: best R@5 = 32.8, current R@5 = 30.7
2022-01-03 04:24:00   Start training epoch: 03
2022-01-03 05:05:10   Finished epoch 03 in 0:41:09, average epoch triplet loss = 0.0984
2022-01-03 05:11:36   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 14.3, R@5: 31.4, R@10: 42.5, R@20: 56.6
2022-01-03 05:11:36   Not improved: 2 / 3: best R@5 = 32.8, current R@5 = 31.4
2022-01-03 05:11:36   Start training epoch: 04
2022-01-03 05:52:46   Finished epoch 04 in 0:41:09, average epoch triplet loss = 0.0982
2022-01-03 05:59:12   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 16.4, R@5: 34.8, R@10: 46.1, R@20: 59.3
2022-01-03 05:59:12   Improved: previous best R@5 = 32.8, current R@5 = 34.8
2022-01-03 05:59:12   Start training epoch: 05
2022-01-03 06:40:22   Finished epoch 05 in 0:41:09, average epoch triplet loss = 0.0983
2022-01-03 06:46:48   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 15.2, R@5: 32.6, R@10: 43.8, R@20: 58.2
2022-01-03 06:46:48   Not improved: 1 / 3: best R@5 = 34.8, current R@5 = 32.6
2022-01-03 06:46:48   Start training epoch: 06
2022-01-03 07:27:57   Finished epoch 06 in 0:41:09, average epoch triplet loss = 0.0980
2022-01-03 07:34:23   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 15.7, R@5: 34.0, R@10: 46.5, R@20: 60.0
2022-01-03 07:34:23   Not improved: 2 / 3: best R@5 = 34.8, current R@5 = 34.0
2022-01-03 07:34:23   Start training epoch: 07
2022-01-03 08:15:33   Finished epoch 07 in 0:41:10, average epoch triplet loss = 0.0982
2022-01-03 08:21:59   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 16.5, R@5: 35.0, R@10: 46.5, R@20: 60.3
2022-01-03 08:21:59   Improved: previous best R@5 = 34.8, current R@5 = 35.0
2022-01-03 08:21:59   Start training epoch: 08
2022-01-03 09:03:10   Finished epoch 08 in 0:41:10, average epoch triplet loss = 0.0977
2022-01-03 09:09:36   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 15.4, R@5: 34.8, R@10: 46.7, R@20: 60.5
2022-01-03 09:09:36   Not improved: 1 / 3: best R@5 = 35.0, current R@5 = 34.8
2022-01-03 09:09:36   Start training epoch: 09
2022-01-03 09:50:48   Finished epoch 09 in 0:41:11, average epoch triplet loss = 0.0982
2022-01-03 09:57:14   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 17.9, R@5: 36.5, R@10: 48.4, R@20: 62.1
2022-01-03 09:57:14   Improved: previous best R@5 = 35.0, current R@5 = 36.5
2022-01-03 09:57:14   Start training epoch: 10
2022-01-03 10:38:26   Finished epoch 10 in 0:41:11, average epoch triplet loss = 0.0975
2022-01-03 10:44:52   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 17.0, R@5: 35.5, R@10: 47.3, R@20: 61.4
2022-01-03 10:44:52   Not improved: 1 / 3: best R@5 = 36.5, current R@5 = 35.5
2022-01-03 10:44:52   Start training epoch: 11
2022-01-03 11:26:05   Finished epoch 11 in 0:41:13, average epoch triplet loss = 0.0978
2022-01-03 11:32:32   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 18.5, R@5: 39.6, R@10: 52.0, R@20: 66.2
2022-01-03 11:32:32   Improved: previous best R@5 = 36.5, current R@5 = 39.6
2022-01-03 11:32:32   Start training epoch: 12
2022-01-03 12:13:47   Finished epoch 12 in 0:41:15, average epoch triplet loss = 0.0966
2022-01-03 12:20:13   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 20.3, R@5: 41.6, R@10: 54.0, R@20: 67.1
2022-01-03 12:20:13   Improved: previous best R@5 = 39.6, current R@5 = 41.6
2022-01-03 12:20:13   Start training epoch: 13
2022-01-03 13:01:28   Finished epoch 13 in 0:41:14, average epoch triplet loss = 0.0973
2022-01-03 13:07:55   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 21.0, R@5: 41.9, R@10: 54.1, R@20: 67.4
2022-01-03 13:07:55   Improved: previous best R@5 = 41.6, current R@5 = 41.9
2022-01-03 13:07:55   Start training epoch: 14
2022-01-03 13:49:11   Finished epoch 14 in 0:41:16, average epoch triplet loss = 0.0973
2022-01-03 13:55:38   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 20.7, R@5: 42.6, R@10: 54.6, R@20: 67.1
2022-01-03 13:55:38   Improved: previous best R@5 = 41.9, current R@5 = 42.6
2022-01-03 13:55:38   Start training epoch: 15
2022-01-03 14:36:53   Finished epoch 15 in 0:41:14, average epoch triplet loss = 0.0970
2022-01-03 14:43:21   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 23.1, R@5: 44.3, R@10: 56.3, R@20: 69.5
2022-01-03 14:43:21   Improved: previous best R@5 = 42.6, current R@5 = 44.3
2022-01-03 14:43:21   Start training epoch: 16
2022-01-03 15:24:37   Finished epoch 16 in 0:41:15, average epoch triplet loss = 0.0974
2022-01-03 15:31:05   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 23.3, R@5: 45.1, R@10: 56.7, R@20: 69.3
2022-01-03 15:31:05   Improved: previous best R@5 = 44.3, current R@5 = 45.1
2022-01-03 15:31:05   Start training epoch: 17
2022-01-03 16:12:19   Finished epoch 17 in 0:41:14, average epoch triplet loss = 0.0971
2022-01-03 16:18:46   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 21.3, R@5: 43.7, R@10: 56.4, R@20: 69.3
2022-01-03 16:18:46   Not improved: 1 / 3: best R@5 = 45.1, current R@5 = 43.7
2022-01-03 16:18:46   Start training epoch: 18
2022-01-03 17:00:01   Finished epoch 18 in 0:41:14, average epoch triplet loss = 0.0966
2022-01-03 17:06:28   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 21.0, R@5: 42.3, R@10: 54.5, R@20: 68.0
2022-01-03 17:06:29   Not improved: 2 / 3: best R@5 = 45.1, current R@5 = 42.3
2022-01-03 17:06:29   Start training epoch: 19
2022-01-03 17:47:42   Finished epoch 19 in 0:41:13, average epoch triplet loss = 0.0964
2022-01-03 17:54:08   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 23.0, R@5: 43.8, R@10: 55.1, R@20: 67.6
2022-01-03 17:54:08   Not improved: 3 / 3: best R@5 = 45.1, current R@5 = 43.8
2022-01-03 17:54:08   Performance did not improve for 3 epochs. Stop training.
2022-01-03 17:54:08   Best R@5: 45.1
2022-01-03 17:54:08   Trained for 20 epochs, in total in 15:53:39
2022-01-03 18:00:18   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 23.5, R@5: 44.3, R@10: 55.6, R@20: 67.5
