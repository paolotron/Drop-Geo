2022-01-11 00:50:42   Arguments: Namespace(augment_data=0, cache_refresh_rate=1000, datasets_folder='../data/', device='cuda', epochs_num=20, exp_name='./runs/NetVlad_abl', gem_power=None, infer_batch_size=16, lr=1e-06, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, optimizer='Adam', output_folder='runs\\./runs/NetVlad_abl\\2022-01-11_00-50-42', patience=3, queries_per_epoch=3000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=2, train_positives_dist_threshold=10, val_positive_dist_threshold=25)
2022-01-11 00:50:42   The outputs are being saved in runs\./runs/NetVlad_abl\2022-01-11_00-50-42
2022-01-11 00:50:42   Using 1 GPUs and 8 CPUs
2022-01-11 00:50:42   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-11 00:50:42   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-11 00:50:43   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-11 00:50:43   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-11 00:50:44   Output dimension of the model is 16384
2022-01-11 00:50:44   Start training epoch: 00
2022-01-11 01:24:02   Finished epoch 00 in 0:33:18, average epoch triplet loss = 0.0836
2022-01-11 01:30:00   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 56.5, R@5: 74.2, R@10: 81.0, R@20: 87.0
2022-01-11 01:30:00   Improved: previous best R@5 = 0.0, current R@5 = 74.2
2022-01-11 01:30:00   Start training epoch: 01
2022-01-11 02:03:05   Finished epoch 01 in 0:33:04, average epoch triplet loss = 0.0815
2022-01-11 02:08:24   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 65.0, R@5: 81.8, R@10: 87.7, R@20: 91.1
2022-01-11 02:08:24   Improved: previous best R@5 = 74.2, current R@5 = 81.8
2022-01-11 02:08:24   Start training epoch: 02
2022-01-11 02:41:37   Finished epoch 02 in 0:33:13, average epoch triplet loss = 0.0798
2022-01-11 02:46:57   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 70.3, R@5: 85.8, R@10: 90.0, R@20: 93.3
2022-01-11 02:46:58   Improved: previous best R@5 = 81.8, current R@5 = 85.8
2022-01-11 02:46:58   Start training epoch: 03
2022-01-11 03:20:12   Finished epoch 03 in 0:33:14, average epoch triplet loss = 0.0795
2022-01-11 03:25:29   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 74.4, R@5: 88.0, R@10: 91.7, R@20: 94.8
2022-01-11 03:25:30   Improved: previous best R@5 = 85.8, current R@5 = 88.0
2022-01-11 03:25:30   Start training epoch: 04
2022-01-11 03:59:10   Finished epoch 04 in 0:33:40, average epoch triplet loss = 0.0780
2022-01-11 04:04:35   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 76.2, R@5: 89.2, R@10: 92.7, R@20: 95.4
2022-01-11 04:04:35   Improved: previous best R@5 = 88.0, current R@5 = 89.2
2022-01-11 04:04:35   Start training epoch: 05
2022-01-11 04:38:00   Finished epoch 05 in 0:33:25, average epoch triplet loss = 0.0771
2022-01-11 04:43:46   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 77.6, R@5: 89.8, R@10: 93.0, R@20: 95.6
2022-01-11 04:43:46   Improved: previous best R@5 = 89.2, current R@5 = 89.8
2022-01-11 04:43:46   Start training epoch: 06
2022-01-11 05:16:50   Finished epoch 06 in 0:33:04, average epoch triplet loss = 0.0774
2022-01-11 05:22:09   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.0, R@5: 90.5, R@10: 93.7, R@20: 96.1
2022-01-11 05:22:09   Improved: previous best R@5 = 89.8, current R@5 = 90.5
2022-01-11 05:22:09   Start training epoch: 07
2022-01-11 05:55:10   Finished epoch 07 in 0:33:01, average epoch triplet loss = 0.0763
2022-01-11 06:00:22   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.4, R@5: 90.7, R@10: 94.0, R@20: 96.1
2022-01-11 06:00:22   Improved: previous best R@5 = 90.5, current R@5 = 90.7
2022-01-11 06:00:22   Start training epoch: 08
2022-01-11 06:33:29   Finished epoch 08 in 0:33:07, average epoch triplet loss = 0.0756
2022-01-11 06:38:51   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.5, R@5: 91.1, R@10: 94.1, R@20: 96.3
2022-01-11 06:38:51   Improved: previous best R@5 = 90.7, current R@5 = 91.1
2022-01-11 06:38:51   Start training epoch: 09
2022-01-11 07:12:02   Finished epoch 09 in 0:33:10, average epoch triplet loss = 0.0748
2022-01-11 07:17:28   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.2, R@5: 91.6, R@10: 94.4, R@20: 96.3
2022-01-11 07:17:28   Improved: previous best R@5 = 91.1, current R@5 = 91.6
2022-01-11 07:17:28   Start training epoch: 10
2022-01-11 07:50:37   Finished epoch 10 in 0:33:09, average epoch triplet loss = 0.0740
2022-01-11 07:56:12   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.6, R@5: 92.0, R@10: 94.4, R@20: 96.3
2022-01-11 07:56:12   Improved: previous best R@5 = 91.6, current R@5 = 92.0
2022-01-11 07:56:12   Start training epoch: 11
2022-01-11 08:30:07   Finished epoch 11 in 0:33:54, average epoch triplet loss = 0.0746
2022-01-11 08:35:26   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.0, R@5: 91.9, R@10: 94.6, R@20: 96.5
2022-01-11 08:35:26   Not improved: 1 / 3: best R@5 = 92.0, current R@5 = 91.9
2022-01-11 08:35:26   Start training epoch: 12
2022-01-11 09:09:11   Finished epoch 12 in 0:33:45, average epoch triplet loss = 0.0730
2022-01-11 09:14:55   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.6, R@5: 92.3, R@10: 94.7, R@20: 96.6
2022-01-11 09:14:56   Improved: previous best R@5 = 92.0, current R@5 = 92.3
2022-01-11 09:14:56   Start training epoch: 13
2022-01-11 09:49:29   Finished epoch 13 in 0:34:33, average epoch triplet loss = 0.0728
2022-01-11 09:54:56   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.2, R@5: 92.6, R@10: 94.9, R@20: 96.7
2022-01-11 09:54:56   Improved: previous best R@5 = 92.3, current R@5 = 92.6
2022-01-11 09:54:56   Start training epoch: 14
2022-01-11 10:28:21   Finished epoch 14 in 0:33:25, average epoch triplet loss = 0.0719
2022-01-11 10:34:01   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.8, R@5: 92.8, R@10: 95.1, R@20: 96.8
2022-01-11 10:34:01   Improved: previous best R@5 = 92.6, current R@5 = 92.8
2022-01-11 10:34:01   Start training epoch: 15
2022-01-11 11:07:26   Finished epoch 15 in 0:33:24, average epoch triplet loss = 0.0721
2022-01-11 11:12:29   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.7, R@5: 92.8, R@10: 95.0, R@20: 96.9
2022-01-11 11:12:29   Not improved: 1 / 3: best R@5 = 92.8, current R@5 = 92.8
2022-01-11 11:12:29   Start training epoch: 16
2022-01-11 11:45:37   Finished epoch 16 in 0:33:08, average epoch triplet loss = 0.0709
2022-01-11 11:50:56   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.4, R@5: 92.7, R@10: 95.0, R@20: 96.8
2022-01-11 11:50:56   Not improved: 2 / 3: best R@5 = 92.8, current R@5 = 92.7
2022-01-11 11:50:56   Start training epoch: 17
2022-01-11 12:23:27   Finished epoch 17 in 0:32:30, average epoch triplet loss = 0.0697
2022-01-11 12:28:24   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 83.2, R@5: 92.8, R@10: 95.2, R@20: 96.7
2022-01-11 12:28:24   Not improved: 3 / 3: best R@5 = 92.8, current R@5 = 92.8
2022-01-11 12:28:24   Performance did not improve for 3 epochs. Stop training.
2022-01-11 12:28:24   Best R@5: 92.8
2022-01-11 12:28:24   Trained for 18 epochs, in total in 11:37:41
2022-01-11 12:33:37   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 81.4, R@5: 91.3, R@10: 93.7, R@20: 95.5
