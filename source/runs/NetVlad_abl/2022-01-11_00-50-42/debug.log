2022-01-11 00:50:42   Arguments: Namespace(augment_data=0, cache_refresh_rate=1000, datasets_folder='../data/', device='cuda', epochs_num=20, exp_name='./runs/NetVlad_abl', gem_power=None, infer_batch_size=16, lr=1e-06, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, optimizer='Adam', output_folder='runs\\./runs/NetVlad_abl\\2022-01-11_00-50-42', patience=3, queries_per_epoch=3000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=2, train_positives_dist_threshold=10, val_positive_dist_threshold=25)
2022-01-11 00:50:42   The outputs are being saved in runs\./runs/NetVlad_abl\2022-01-11_00-50-42
2022-01-11 00:50:42   Using 1 GPUs and 8 CPUs
2022-01-11 00:50:42   Loading dataset Pitts30k from folder ../data/
2022-01-11 00:50:42   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-11 00:50:42   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-11 00:50:43   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-11 00:50:43   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-11 00:50:44   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-11 00:50:44   Output dimension of the model is 16384
2022-01-11 00:50:44   Start training epoch: 00
2022-01-11 00:50:44   Cache: 0 / 3
2022-01-11 01:01:44   Epoch[00](0/3): current batch triplet loss = 0.0668, average epoch triplet loss = 0.0840
2022-01-11 01:01:44   Cache: 1 / 3
2022-01-11 01:12:51   Epoch[00](1/3): current batch triplet loss = 0.1026, average epoch triplet loss = 0.0842
2022-01-11 01:12:51   Cache: 2 / 3
2022-01-11 01:24:02   Epoch[00](2/3): current batch triplet loss = 0.0903, average epoch triplet loss = 0.0836
2022-01-11 01:24:02   Finished epoch 00 in 0:33:18, average epoch triplet loss = 0.0836
2022-01-11 01:24:02   Extracting database features for evaluation/testing
2022-01-11 01:27:00   Extracting queries features for evaluation/testing
2022-01-11 01:29:24   Calculating recalls
2022-01-11 01:30:00   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 56.5, R@5: 74.2, R@10: 81.0, R@20: 87.0
2022-01-11 01:30:00   Improved: previous best R@5 = 0.0, current R@5 = 74.2
2022-01-11 01:30:00   Start training epoch: 01
2022-01-11 01:30:00   Cache: 0 / 3
2022-01-11 01:41:08   Epoch[01](0/3): current batch triplet loss = 0.0937, average epoch triplet loss = 0.0824
2022-01-11 01:41:08   Cache: 1 / 3
2022-01-11 01:52:08   Epoch[01](1/3): current batch triplet loss = 0.0837, average epoch triplet loss = 0.0820
2022-01-11 01:52:08   Cache: 2 / 3
2022-01-11 02:03:05   Epoch[01](2/3): current batch triplet loss = 0.0956, average epoch triplet loss = 0.0815
2022-01-11 02:03:05   Finished epoch 01 in 0:33:04, average epoch triplet loss = 0.0815
2022-01-11 02:03:05   Extracting database features for evaluation/testing
2022-01-11 02:05:40   Extracting queries features for evaluation/testing
2022-01-11 02:07:48   Calculating recalls
2022-01-11 02:08:24   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 65.0, R@5: 81.8, R@10: 87.7, R@20: 91.1
2022-01-11 02:08:24   Improved: previous best R@5 = 74.2, current R@5 = 81.8
2022-01-11 02:08:24   Start training epoch: 02
2022-01-11 02:08:24   Cache: 0 / 3
2022-01-11 02:19:43   Epoch[02](0/3): current batch triplet loss = 0.0915, average epoch triplet loss = 0.0799
2022-01-11 02:19:43   Cache: 1 / 3
2022-01-11 02:30:41   Epoch[02](1/3): current batch triplet loss = 0.0890, average epoch triplet loss = 0.0799
2022-01-11 02:30:41   Cache: 2 / 3
2022-01-11 02:41:37   Epoch[02](2/3): current batch triplet loss = 0.0824, average epoch triplet loss = 0.0798
2022-01-11 02:41:37   Finished epoch 02 in 0:33:13, average epoch triplet loss = 0.0798
2022-01-11 02:41:37   Extracting database features for evaluation/testing
2022-01-11 02:44:14   Extracting queries features for evaluation/testing
2022-01-11 02:46:22   Calculating recalls
2022-01-11 02:46:57   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 70.3, R@5: 85.8, R@10: 90.0, R@20: 93.3
2022-01-11 02:46:58   Improved: previous best R@5 = 81.8, current R@5 = 85.8
2022-01-11 02:46:58   Start training epoch: 03
2022-01-11 02:46:58   Cache: 0 / 3
2022-01-11 02:58:15   Epoch[03](0/3): current batch triplet loss = 0.0920, average epoch triplet loss = 0.0797
2022-01-11 02:58:15   Cache: 1 / 3
2022-01-11 03:09:15   Epoch[03](1/3): current batch triplet loss = 0.0834, average epoch triplet loss = 0.0794
2022-01-11 03:09:15   Cache: 2 / 3
2022-01-11 03:20:12   Epoch[03](2/3): current batch triplet loss = 0.0877, average epoch triplet loss = 0.0795
2022-01-11 03:20:12   Finished epoch 03 in 0:33:14, average epoch triplet loss = 0.0795
2022-01-11 03:20:12   Extracting database features for evaluation/testing
2022-01-11 03:22:47   Extracting queries features for evaluation/testing
2022-01-11 03:24:54   Calculating recalls
2022-01-11 03:25:29   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 74.4, R@5: 88.0, R@10: 91.7, R@20: 94.8
2022-01-11 03:25:30   Improved: previous best R@5 = 85.8, current R@5 = 88.0
2022-01-11 03:25:30   Start training epoch: 04
2022-01-11 03:25:30   Cache: 0 / 3
2022-01-11 03:36:43   Epoch[04](0/3): current batch triplet loss = 0.0429, average epoch triplet loss = 0.0785
2022-01-11 03:36:43   Cache: 1 / 3
2022-01-11 03:48:11   Epoch[04](1/3): current batch triplet loss = 0.0481, average epoch triplet loss = 0.0780
2022-01-11 03:48:11   Cache: 2 / 3
2022-01-11 03:59:10   Epoch[04](2/3): current batch triplet loss = 0.0745, average epoch triplet loss = 0.0780
2022-01-11 03:59:10   Finished epoch 04 in 0:33:40, average epoch triplet loss = 0.0780
2022-01-11 03:59:10   Extracting database features for evaluation/testing
2022-01-11 04:01:46   Extracting queries features for evaluation/testing
2022-01-11 04:04:00   Calculating recalls
2022-01-11 04:04:35   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 76.2, R@5: 89.2, R@10: 92.7, R@20: 95.4
2022-01-11 04:04:35   Improved: previous best R@5 = 88.0, current R@5 = 89.2
2022-01-11 04:04:35   Start training epoch: 05
2022-01-11 04:04:35   Cache: 0 / 3
2022-01-11 04:15:57   Epoch[05](0/3): current batch triplet loss = 0.0794, average epoch triplet loss = 0.0759
2022-01-11 04:15:57   Cache: 1 / 3
2022-01-11 04:27:04   Epoch[05](1/3): current batch triplet loss = 0.0775, average epoch triplet loss = 0.0768
2022-01-11 04:27:04   Cache: 2 / 3
2022-01-11 04:38:00   Epoch[05](2/3): current batch triplet loss = 0.0373, average epoch triplet loss = 0.0771
2022-01-11 04:38:00   Finished epoch 05 in 0:33:25, average epoch triplet loss = 0.0771
2022-01-11 04:38:00   Extracting database features for evaluation/testing
2022-01-11 04:40:53   Extracting queries features for evaluation/testing
2022-01-11 04:43:11   Calculating recalls
2022-01-11 04:43:46   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 77.6, R@5: 89.8, R@10: 93.0, R@20: 95.6
2022-01-11 04:43:46   Improved: previous best R@5 = 89.2, current R@5 = 89.8
2022-01-11 04:43:46   Start training epoch: 06
2022-01-11 04:43:46   Cache: 0 / 3
2022-01-11 04:55:00   Epoch[06](0/3): current batch triplet loss = 0.0994, average epoch triplet loss = 0.0771
2022-01-11 04:55:00   Cache: 1 / 3
2022-01-11 05:05:53   Epoch[06](1/3): current batch triplet loss = 0.0937, average epoch triplet loss = 0.0772
2022-01-11 05:05:53   Cache: 2 / 3
2022-01-11 05:16:50   Epoch[06](2/3): current batch triplet loss = 0.0764, average epoch triplet loss = 0.0774
2022-01-11 05:16:50   Finished epoch 06 in 0:33:04, average epoch triplet loss = 0.0774
2022-01-11 05:16:50   Extracting database features for evaluation/testing
2022-01-11 05:19:27   Extracting queries features for evaluation/testing
2022-01-11 05:21:34   Calculating recalls
2022-01-11 05:22:09   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.0, R@5: 90.5, R@10: 93.7, R@20: 96.1
2022-01-11 05:22:09   Improved: previous best R@5 = 89.8, current R@5 = 90.5
2022-01-11 05:22:09   Start training epoch: 07
2022-01-11 05:22:09   Cache: 0 / 3
2022-01-11 05:33:23   Epoch[07](0/3): current batch triplet loss = 0.0943, average epoch triplet loss = 0.0756
2022-01-11 05:33:23   Cache: 1 / 3
2022-01-11 05:44:18   Epoch[07](1/3): current batch triplet loss = 0.0844, average epoch triplet loss = 0.0763
2022-01-11 05:44:18   Cache: 2 / 3
2022-01-11 05:55:10   Epoch[07](2/3): current batch triplet loss = 0.0730, average epoch triplet loss = 0.0763
2022-01-11 05:55:10   Finished epoch 07 in 0:33:01, average epoch triplet loss = 0.0763
2022-01-11 05:55:10   Extracting database features for evaluation/testing
2022-01-11 05:57:43   Extracting queries features for evaluation/testing
2022-01-11 05:59:48   Calculating recalls
2022-01-11 06:00:22   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.4, R@5: 90.7, R@10: 94.0, R@20: 96.1
2022-01-11 06:00:22   Improved: previous best R@5 = 90.5, current R@5 = 90.7
2022-01-11 06:00:22   Start training epoch: 08
2022-01-11 06:00:22   Cache: 0 / 3
2022-01-11 06:11:41   Epoch[08](0/3): current batch triplet loss = 0.0829, average epoch triplet loss = 0.0761
2022-01-11 06:11:41   Cache: 1 / 3
2022-01-11 06:22:36   Epoch[08](1/3): current batch triplet loss = 0.0490, average epoch triplet loss = 0.0761
2022-01-11 06:22:36   Cache: 2 / 3
2022-01-11 06:33:29   Epoch[08](2/3): current batch triplet loss = 0.0474, average epoch triplet loss = 0.0756
2022-01-11 06:33:29   Finished epoch 08 in 0:33:07, average epoch triplet loss = 0.0756
2022-01-11 06:33:29   Extracting database features for evaluation/testing
2022-01-11 06:36:05   Extracting queries features for evaluation/testing
2022-01-11 06:38:16   Calculating recalls
2022-01-11 06:38:51   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.5, R@5: 91.1, R@10: 94.1, R@20: 96.3
2022-01-11 06:38:51   Improved: previous best R@5 = 90.7, current R@5 = 91.1
2022-01-11 06:38:51   Start training epoch: 09
2022-01-11 06:38:51   Cache: 0 / 3
2022-01-11 06:50:06   Epoch[09](0/3): current batch triplet loss = 0.0639, average epoch triplet loss = 0.0754
2022-01-11 06:50:06   Cache: 1 / 3
2022-01-11 07:01:01   Epoch[09](1/3): current batch triplet loss = 0.0191, average epoch triplet loss = 0.0748
2022-01-11 07:01:01   Cache: 2 / 3
2022-01-11 07:12:02   Epoch[09](2/3): current batch triplet loss = 0.0572, average epoch triplet loss = 0.0748
2022-01-11 07:12:02   Finished epoch 09 in 0:33:10, average epoch triplet loss = 0.0748
2022-01-11 07:12:02   Extracting database features for evaluation/testing
2022-01-11 07:14:39   Extracting queries features for evaluation/testing
2022-01-11 07:16:52   Calculating recalls
2022-01-11 07:17:28   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.2, R@5: 91.6, R@10: 94.4, R@20: 96.3
2022-01-11 07:17:28   Improved: previous best R@5 = 91.1, current R@5 = 91.6
2022-01-11 07:17:28   Start training epoch: 10
2022-01-11 07:17:28   Cache: 0 / 3
2022-01-11 07:28:46   Epoch[10](0/3): current batch triplet loss = 0.0781, average epoch triplet loss = 0.0748
2022-01-11 07:28:46   Cache: 1 / 3
2022-01-11 07:39:41   Epoch[10](1/3): current batch triplet loss = 0.0738, average epoch triplet loss = 0.0745
2022-01-11 07:39:41   Cache: 2 / 3
2022-01-11 07:50:37   Epoch[10](2/3): current batch triplet loss = 0.0410, average epoch triplet loss = 0.0740
2022-01-11 07:50:37   Finished epoch 10 in 0:33:09, average epoch triplet loss = 0.0740
2022-01-11 07:50:37   Extracting database features for evaluation/testing
2022-01-11 07:53:13   Extracting queries features for evaluation/testing
2022-01-11 07:55:37   Calculating recalls
2022-01-11 07:56:12   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.6, R@5: 92.0, R@10: 94.4, R@20: 96.3
2022-01-11 07:56:12   Improved: previous best R@5 = 91.6, current R@5 = 92.0
2022-01-11 07:56:12   Start training epoch: 11
2022-01-11 07:56:12   Cache: 0 / 3
2022-01-11 08:07:43   Epoch[11](0/3): current batch triplet loss = 0.0989, average epoch triplet loss = 0.0750
2022-01-11 08:07:43   Cache: 1 / 3
2022-01-11 08:18:56   Epoch[11](1/3): current batch triplet loss = 0.0544, average epoch triplet loss = 0.0745
2022-01-11 08:18:56   Cache: 2 / 3
2022-01-11 08:30:07   Epoch[11](2/3): current batch triplet loss = 0.0780, average epoch triplet loss = 0.0746
2022-01-11 08:30:07   Finished epoch 11 in 0:33:54, average epoch triplet loss = 0.0746
2022-01-11 08:30:07   Extracting database features for evaluation/testing
2022-01-11 08:32:43   Extracting queries features for evaluation/testing
2022-01-11 08:34:50   Calculating recalls
2022-01-11 08:35:26   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.0, R@5: 91.9, R@10: 94.6, R@20: 96.5
2022-01-11 08:35:26   Not improved: 1 / 3: best R@5 = 92.0, current R@5 = 91.9
2022-01-11 08:35:26   Start training epoch: 12
2022-01-11 08:35:26   Cache: 0 / 3
2022-01-11 08:46:12   Epoch[12](0/3): current batch triplet loss = 0.0768, average epoch triplet loss = 0.0713
2022-01-11 08:46:12   Cache: 1 / 3
2022-01-11 08:57:27   Epoch[12](1/3): current batch triplet loss = 0.0864, average epoch triplet loss = 0.0722
2022-01-11 08:57:27   Cache: 2 / 3
2022-01-11 09:09:11   Epoch[12](2/3): current batch triplet loss = 0.0741, average epoch triplet loss = 0.0730
2022-01-11 09:09:11   Finished epoch 12 in 0:33:45, average epoch triplet loss = 0.0730
2022-01-11 09:09:11   Extracting database features for evaluation/testing
2022-01-11 09:12:03   Extracting queries features for evaluation/testing
2022-01-11 09:14:22   Calculating recalls
2022-01-11 09:14:55   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.6, R@5: 92.3, R@10: 94.7, R@20: 96.6
2022-01-11 09:14:56   Improved: previous best R@5 = 92.0, current R@5 = 92.3
2022-01-11 09:14:56   Start training epoch: 13
2022-01-11 09:14:56   Cache: 0 / 3
2022-01-11 09:26:10   Epoch[13](0/3): current batch triplet loss = 0.0613, average epoch triplet loss = 0.0725
2022-01-11 09:26:10   Cache: 1 / 3
2022-01-11 09:37:55   Epoch[13](1/3): current batch triplet loss = 0.0757, average epoch triplet loss = 0.0729
2022-01-11 09:37:55   Cache: 2 / 3
2022-01-11 09:49:29   Epoch[13](2/3): current batch triplet loss = 0.0888, average epoch triplet loss = 0.0728
2022-01-11 09:49:29   Finished epoch 13 in 0:34:33, average epoch triplet loss = 0.0728
2022-01-11 09:49:29   Extracting database features for evaluation/testing
2022-01-11 09:52:22   Extracting queries features for evaluation/testing
2022-01-11 09:54:23   Calculating recalls
2022-01-11 09:54:56   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.2, R@5: 92.6, R@10: 94.9, R@20: 96.7
2022-01-11 09:54:56   Improved: previous best R@5 = 92.3, current R@5 = 92.6
2022-01-11 09:54:56   Start training epoch: 14
2022-01-11 09:54:56   Cache: 0 / 3
2022-01-11 10:05:49   Epoch[14](0/3): current batch triplet loss = 0.0555, average epoch triplet loss = 0.0732
2022-01-11 10:05:49   Cache: 1 / 3
2022-01-11 10:16:51   Epoch[14](1/3): current batch triplet loss = 0.0988, average epoch triplet loss = 0.0720
2022-01-11 10:16:51   Cache: 2 / 3
2022-01-11 10:28:21   Epoch[14](2/3): current batch triplet loss = 0.0636, average epoch triplet loss = 0.0719
2022-01-11 10:28:21   Finished epoch 14 in 0:33:25, average epoch triplet loss = 0.0719
2022-01-11 10:28:21   Extracting database features for evaluation/testing
2022-01-11 10:31:09   Extracting queries features for evaluation/testing
2022-01-11 10:33:28   Calculating recalls
2022-01-11 10:34:01   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.8, R@5: 92.8, R@10: 95.1, R@20: 96.8
2022-01-11 10:34:01   Improved: previous best R@5 = 92.6, current R@5 = 92.8
2022-01-11 10:34:01   Start training epoch: 15
2022-01-11 10:34:01   Cache: 0 / 3
2022-01-11 10:45:21   Epoch[15](0/3): current batch triplet loss = 0.0892, average epoch triplet loss = 0.0729
2022-01-11 10:45:21   Cache: 1 / 3
2022-01-11 10:56:16   Epoch[15](1/3): current batch triplet loss = 0.0614, average epoch triplet loss = 0.0720
2022-01-11 10:56:16   Cache: 2 / 3
2022-01-11 11:07:26   Epoch[15](2/3): current batch triplet loss = 0.0724, average epoch triplet loss = 0.0721
2022-01-11 11:07:26   Finished epoch 15 in 0:33:24, average epoch triplet loss = 0.0721
2022-01-11 11:07:26   Extracting database features for evaluation/testing
2022-01-11 11:09:54   Extracting queries features for evaluation/testing
2022-01-11 11:12:02   Calculating recalls
2022-01-11 11:12:29   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.7, R@5: 92.8, R@10: 95.0, R@20: 96.9
2022-01-11 11:12:29   Not improved: 1 / 3: best R@5 = 92.8, current R@5 = 92.8
2022-01-11 11:12:29   Start training epoch: 16
2022-01-11 11:12:29   Cache: 0 / 3
2022-01-11 11:23:33   Epoch[16](0/3): current batch triplet loss = 0.0407, average epoch triplet loss = 0.0712
2022-01-11 11:23:33   Cache: 1 / 3
2022-01-11 11:34:25   Epoch[16](1/3): current batch triplet loss = 0.0718, average epoch triplet loss = 0.0711
2022-01-11 11:34:25   Cache: 2 / 3
2022-01-11 11:45:37   Epoch[16](2/3): current batch triplet loss = 0.0690, average epoch triplet loss = 0.0709
2022-01-11 11:45:37   Finished epoch 16 in 0:33:08, average epoch triplet loss = 0.0709
2022-01-11 11:45:37   Extracting database features for evaluation/testing
2022-01-11 11:48:12   Extracting queries features for evaluation/testing
2022-01-11 11:50:22   Calculating recalls
2022-01-11 11:50:56   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.4, R@5: 92.7, R@10: 95.0, R@20: 96.8
2022-01-11 11:50:56   Not improved: 2 / 3: best R@5 = 92.8, current R@5 = 92.7
2022-01-11 11:50:56   Start training epoch: 17
2022-01-11 11:50:56   Cache: 0 / 3
2022-01-11 12:01:49   Epoch[17](0/3): current batch triplet loss = 0.1122, average epoch triplet loss = 0.0698
2022-01-11 12:01:49   Cache: 1 / 3
2022-01-11 12:12:41   Epoch[17](1/3): current batch triplet loss = 0.0918, average epoch triplet loss = 0.0695
2022-01-11 12:12:41   Cache: 2 / 3
2022-01-11 12:23:27   Epoch[17](2/3): current batch triplet loss = 0.0629, average epoch triplet loss = 0.0697
2022-01-11 12:23:27   Finished epoch 17 in 0:32:30, average epoch triplet loss = 0.0697
2022-01-11 12:23:27   Extracting database features for evaluation/testing
2022-01-11 12:25:55   Extracting queries features for evaluation/testing
2022-01-11 12:27:53   Calculating recalls
2022-01-11 12:28:24   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 83.2, R@5: 92.8, R@10: 95.2, R@20: 96.7
2022-01-11 12:28:24   Not improved: 3 / 3: best R@5 = 92.8, current R@5 = 92.8
2022-01-11 12:28:24   Performance did not improve for 3 epochs. Stop training.
2022-01-11 12:28:24   Best R@5: 92.8
2022-01-11 12:28:24   Trained for 18 epochs, in total in 11:37:41
2022-01-11 12:28:24   Extracting database features for evaluation/testing
2022-01-11 12:31:09   Extracting queries features for evaluation/testing
2022-01-11 12:33:11   Calculating recalls
2022-01-11 12:33:37   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 81.4, R@5: 91.3, R@10: 93.7, R@20: 95.5
