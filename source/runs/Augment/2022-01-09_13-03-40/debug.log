2022-01-09 13:03:40   Arguments: Namespace(augment_data=True, cache_refresh_rate=1000, datasets_folder='../data/', device='cuda', epochs_num=20, exp_name='./runs/augment', gem_power=None, infer_batch_size=16, lr=0.0001, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=32, num_workers=4, optimizer='Adam', output_folder='runs\\./runs/augment\\2022-01-09_13-03-40', patience=3, queries_per_epoch=3000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=2, train_positives_dist_threshold=10, val_positive_dist_threshold=25)
2022-01-09 13:03:40   The outputs are being saved in runs\./runs/augment\2022-01-09_13-03-40
2022-01-09 13:03:40   Using 1 GPUs and 8 CPUs
2022-01-09 13:03:40   Loading dataset Pitts30k from folder ../data/
2022-01-09 13:03:41   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-09 13:03:41   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-09 13:03:41   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-09 13:03:42   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-09 13:03:43   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-09 13:03:43   Output dimension of the model is 8192
2022-01-09 13:03:43   Start training epoch: 00
2022-01-09 13:03:43   Cache: 0 / 3
2022-01-09 13:12:18   Epoch[00](0/3): current batch triplet loss = 0.0936, average epoch triplet loss = 0.0982
2022-01-09 13:12:18   Cache: 1 / 3
2022-01-09 13:20:54   Epoch[00](1/3): current batch triplet loss = 0.1007, average epoch triplet loss = 0.0982
2022-01-09 13:20:54   Cache: 2 / 3
2022-01-09 13:29:33   Epoch[00](2/3): current batch triplet loss = 0.1006, average epoch triplet loss = 0.0981
2022-01-09 13:29:33   Finished epoch 00 in 0:25:50, average epoch triplet loss = 0.0981
2022-01-09 13:29:33   Extracting database features for evaluation/testing
2022-01-09 13:32:35   Extracting queries features for evaluation/testing
2022-01-09 13:34:55   Calculating recalls
2022-01-09 13:35:13   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 46.0, R@5: 67.9, R@10: 75.8, R@20: 82.8
2022-01-09 13:35:13   Improved: previous best R@5 = 0.0, current R@5 = 67.9
2022-01-09 13:35:13   Start training epoch: 01
2022-01-09 13:35:13   Cache: 0 / 3
2022-01-09 13:43:28   Epoch[01](0/3): current batch triplet loss = 0.0992, average epoch triplet loss = 0.0980
2022-01-09 13:43:28   Cache: 1 / 3
2022-01-09 13:51:27   Epoch[01](1/3): current batch triplet loss = 0.0956, average epoch triplet loss = 0.0974
2022-01-09 13:51:27   Cache: 2 / 3
2022-01-09 13:59:22   Epoch[01](2/3): current batch triplet loss = 0.0987, average epoch triplet loss = 0.0973
2022-01-09 13:59:22   Finished epoch 01 in 0:24:09, average epoch triplet loss = 0.0973
2022-01-09 13:59:22   Extracting database features for evaluation/testing
2022-01-09 14:01:45   Extracting queries features for evaluation/testing
2022-01-09 14:03:49   Calculating recalls
2022-01-09 14:04:07   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 49.9, R@5: 69.8, R@10: 77.6, R@20: 84.5
2022-01-09 14:04:07   Improved: previous best R@5 = 67.9, current R@5 = 69.8
2022-01-09 14:04:07   Start training epoch: 02
2022-01-09 14:04:07   Cache: 0 / 3
2022-01-09 14:12:51   Epoch[02](0/3): current batch triplet loss = 0.0963, average epoch triplet loss = 0.0965
2022-01-09 14:12:51   Cache: 1 / 3
2022-01-09 14:20:47   Epoch[02](1/3): current batch triplet loss = 0.0926, average epoch triplet loss = 0.0966
2022-01-09 14:20:47   Cache: 2 / 3
2022-01-09 14:28:44   Epoch[02](2/3): current batch triplet loss = 0.0961, average epoch triplet loss = 0.0967
2022-01-09 14:28:44   Finished epoch 02 in 0:24:37, average epoch triplet loss = 0.0967
2022-01-09 14:28:44   Extracting database features for evaluation/testing
2022-01-09 14:31:03   Extracting queries features for evaluation/testing
2022-01-09 14:32:58   Calculating recalls
2022-01-09 14:33:15   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 50.0, R@5: 69.5, R@10: 77.0, R@20: 83.5
2022-01-09 14:33:15   Not improved: 1 / 3: best R@5 = 69.8, current R@5 = 69.5
2022-01-09 14:33:15   Start training epoch: 03
2022-01-09 14:33:15   Cache: 0 / 3
2022-01-09 14:41:23   Epoch[03](0/3): current batch triplet loss = 0.0992, average epoch triplet loss = 0.0964
2022-01-09 14:41:23   Cache: 1 / 3
2022-01-09 14:49:15   Epoch[03](1/3): current batch triplet loss = 0.0981, average epoch triplet loss = 0.0960
2022-01-09 14:49:15   Cache: 2 / 3
2022-01-09 14:57:07   Epoch[03](2/3): current batch triplet loss = 0.0987, average epoch triplet loss = 0.0958
2022-01-09 14:57:07   Finished epoch 03 in 0:23:52, average epoch triplet loss = 0.0958
2022-01-09 14:57:07   Extracting database features for evaluation/testing
2022-01-09 14:59:30   Extracting queries features for evaluation/testing
2022-01-09 15:01:25   Calculating recalls
2022-01-09 15:01:41   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 56.4, R@5: 76.2, R@10: 82.8, R@20: 88.0
2022-01-09 15:01:41   Improved: previous best R@5 = 69.8, current R@5 = 76.2
2022-01-09 15:01:41   Start training epoch: 04
2022-01-09 15:01:41   Cache: 0 / 3
2022-01-09 15:09:55   Epoch[04](0/3): current batch triplet loss = 0.0759, average epoch triplet loss = 0.0943
2022-01-09 15:09:55   Cache: 1 / 3
2022-01-09 15:17:53   Epoch[04](1/3): current batch triplet loss = 0.0989, average epoch triplet loss = 0.0944
2022-01-09 15:17:53   Cache: 2 / 3
2022-01-09 15:25:47   Epoch[04](2/3): current batch triplet loss = 0.1431, average epoch triplet loss = 0.0945
2022-01-09 15:25:47   Finished epoch 04 in 0:24:05, average epoch triplet loss = 0.0945
2022-01-09 15:25:47   Extracting database features for evaluation/testing
2022-01-09 15:28:05   Extracting queries features for evaluation/testing
2022-01-09 15:29:58   Calculating recalls
2022-01-09 15:30:14   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 36.2, R@5: 57.5, R@10: 67.1, R@20: 76.1
2022-01-09 15:30:14   Not improved: 1 / 3: best R@5 = 76.2, current R@5 = 57.5
2022-01-09 15:30:14   Start training epoch: 05
2022-01-09 15:30:14   Cache: 0 / 3
2022-01-09 15:38:25   Epoch[05](0/3): current batch triplet loss = 0.0993, average epoch triplet loss = 0.0963
2022-01-09 15:38:25   Cache: 1 / 3
2022-01-09 15:46:20   Epoch[05](1/3): current batch triplet loss = 0.0930, average epoch triplet loss = 0.0959
2022-01-09 15:46:20   Cache: 2 / 3
2022-01-09 15:54:15   Epoch[05](2/3): current batch triplet loss = 0.0694, average epoch triplet loss = 0.0958
2022-01-09 15:54:15   Finished epoch 05 in 0:24:00, average epoch triplet loss = 0.0958
2022-01-09 15:54:15   Extracting database features for evaluation/testing
2022-01-09 15:56:35   Extracting queries features for evaluation/testing
2022-01-09 15:58:32   Calculating recalls
2022-01-09 15:58:49   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 38.6, R@5: 59.0, R@10: 68.1, R@20: 77.0
2022-01-09 15:58:49   Not improved: 2 / 3: best R@5 = 76.2, current R@5 = 59.0
2022-01-09 15:58:49   Start training epoch: 06
2022-01-09 15:58:49   Cache: 0 / 3
2022-01-09 16:06:58   Epoch[06](0/3): current batch triplet loss = 0.1077, average epoch triplet loss = 0.0957
2022-01-09 16:06:58   Cache: 1 / 3
2022-01-09 16:14:53   Epoch[06](1/3): current batch triplet loss = 0.0912, average epoch triplet loss = 0.0960
2022-01-09 16:14:53   Cache: 2 / 3
2022-01-09 16:22:47   Epoch[06](2/3): current batch triplet loss = 0.0849, average epoch triplet loss = 0.0958
2022-01-09 16:22:47   Finished epoch 06 in 0:23:58, average epoch triplet loss = 0.0958
2022-01-09 16:22:47   Extracting database features for evaluation/testing
2022-01-09 16:25:10   Extracting queries features for evaluation/testing
2022-01-09 16:27:07   Calculating recalls
2022-01-09 16:27:24   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 42.0, R@5: 61.8, R@10: 70.5, R@20: 79.0
2022-01-09 16:27:24   Not improved: 3 / 3: best R@5 = 76.2, current R@5 = 61.8
2022-01-09 16:27:24   Performance did not improve for 3 epochs. Stop training.
2022-01-09 16:27:24   Best R@5: 76.2
2022-01-09 16:27:24   Trained for 07 epochs, in total in 3:23:43
2022-01-09 16:27:24   Extracting database features for evaluation/testing
2022-01-09 16:30:05   Extracting queries features for evaluation/testing
2022-01-09 16:31:58   Calculating recalls
2022-01-09 16:32:13   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 55.4, R@5: 74.8, R@10: 82.1, R@20: 87.9
