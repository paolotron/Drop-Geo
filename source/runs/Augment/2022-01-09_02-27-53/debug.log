2022-01-09 02:27:53   Arguments: Namespace(augment_data=True, cache_refresh_rate=1000, datasets_folder='../data/', device='cuda', epochs_num=20, exp_name='./runs/augment', gem_power=None, infer_batch_size=16, lr=0.0001, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=32, num_workers=4, optimizer='Adam', output_folder='runs\\./runs/augment\\2022-01-09_02-27-53', patience=3, queries_per_epoch=3000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=2, train_positives_dist_threshold=10, val_positive_dist_threshold=25)
2022-01-09 02:27:53   The outputs are being saved in runs\./runs/augment\2022-01-09_02-27-53
2022-01-09 02:27:53   Using 1 GPUs and 8 CPUs
2022-01-09 02:27:53   Loading dataset Pitts30k from folder ../data/
2022-01-09 02:27:53   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-09 02:27:53   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-09 02:27:54   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-09 02:27:54   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-09 02:27:55   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-09 02:27:55   Output dimension of the model is 8192
2022-01-09 02:27:55   Start training epoch: 00
2022-01-09 02:27:55   Cache: 0 / 3
2022-01-09 02:36:25   Epoch[00](0/3): current batch triplet loss = 0.0904, average epoch triplet loss = 0.0982
2022-01-09 02:36:25   Cache: 1 / 3
2022-01-09 02:44:52   Epoch[00](1/3): current batch triplet loss = 0.0992, average epoch triplet loss = 0.0980
2022-01-09 02:44:52   Cache: 2 / 3
2022-01-09 02:53:20   Epoch[00](2/3): current batch triplet loss = 0.0962, average epoch triplet loss = 0.0977
2022-01-09 02:53:20   Finished epoch 00 in 0:25:25, average epoch triplet loss = 0.0977
2022-01-09 02:53:20   Extracting database features for evaluation/testing
2022-01-09 02:56:10   Extracting queries features for evaluation/testing
2022-01-09 02:58:22   Calculating recalls
2022-01-09 02:58:41   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 46.1, R@5: 67.2, R@10: 76.1, R@20: 83.6
2022-01-09 02:58:41   Improved: previous best R@5 = 0.0, current R@5 = 67.2
2022-01-09 02:58:41   Start training epoch: 01
2022-01-09 02:58:41   Cache: 0 / 3
2022-01-09 03:07:06   Epoch[01](0/3): current batch triplet loss = 0.0963, average epoch triplet loss = 0.0971
2022-01-09 03:07:06   Cache: 1 / 3
2022-01-09 03:15:29   Epoch[01](1/3): current batch triplet loss = 0.0950, average epoch triplet loss = 0.0968
2022-01-09 03:15:29   Cache: 2 / 3
2022-01-09 03:23:54   Epoch[01](2/3): current batch triplet loss = 0.0984, average epoch triplet loss = 0.0966
2022-01-09 03:23:54   Finished epoch 01 in 0:25:13, average epoch triplet loss = 0.0966
2022-01-09 03:23:54   Extracting database features for evaluation/testing
2022-01-09 03:26:25   Extracting queries features for evaluation/testing
2022-01-09 03:28:27   Calculating recalls
2022-01-09 03:28:46   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 52.8, R@5: 73.3, R@10: 80.2, R@20: 86.4
2022-01-09 03:28:46   Improved: previous best R@5 = 67.2, current R@5 = 73.3
2022-01-09 03:28:46   Start training epoch: 02
2022-01-09 03:28:46   Cache: 0 / 3
2022-01-09 03:37:09   Epoch[02](0/3): current batch triplet loss = 0.1012, average epoch triplet loss = 0.0966
2022-01-09 03:37:09   Cache: 1 / 3
2022-01-09 03:45:33   Epoch[02](1/3): current batch triplet loss = 0.1602, average epoch triplet loss = 0.0965
2022-01-09 03:45:33   Cache: 2 / 3
2022-01-09 03:53:58   Epoch[02](2/3): current batch triplet loss = 0.0978, average epoch triplet loss = 0.0963
2022-01-09 03:53:58   Finished epoch 02 in 0:25:12, average epoch triplet loss = 0.0963
2022-01-09 03:53:58   Extracting database features for evaluation/testing
2022-01-09 03:56:30   Extracting queries features for evaluation/testing
2022-01-09 03:58:34   Calculating recalls
2022-01-09 03:58:52   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 53.3, R@5: 74.3, R@10: 81.4, R@20: 86.9
2022-01-09 03:58:53   Improved: previous best R@5 = 73.3, current R@5 = 74.3
2022-01-09 03:58:53   Start training epoch: 03
2022-01-09 03:58:53   Cache: 0 / 3
2022-01-09 04:07:17   Epoch[03](0/3): current batch triplet loss = 0.1001, average epoch triplet loss = 0.0958
2022-01-09 04:07:17   Cache: 1 / 3
2022-01-09 04:15:50   Epoch[03](1/3): current batch triplet loss = 0.0958, average epoch triplet loss = 0.0958
2022-01-09 04:15:50   Cache: 2 / 3
2022-01-09 04:24:25   Epoch[03](2/3): current batch triplet loss = 0.0958, average epoch triplet loss = 0.0960
2022-01-09 04:24:25   Finished epoch 03 in 0:25:32, average epoch triplet loss = 0.0960
2022-01-09 04:24:25   Extracting database features for evaluation/testing
2022-01-09 04:27:17   Extracting queries features for evaluation/testing
2022-01-09 04:29:35   Calculating recalls
2022-01-09 04:29:54   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 47.0, R@5: 68.2, R@10: 75.9, R@20: 83.6
2022-01-09 04:29:54   Not improved: 1 / 3: best R@5 = 74.3, current R@5 = 68.2
2022-01-09 04:29:54   Start training epoch: 04
2022-01-09 04:29:54   Cache: 0 / 3
2022-01-09 04:38:22   Epoch[04](0/3): current batch triplet loss = 0.0897, average epoch triplet loss = 0.0961
2022-01-09 04:38:22   Cache: 1 / 3
2022-01-09 04:46:51   Epoch[04](1/3): current batch triplet loss = 0.1282, average epoch triplet loss = 0.0959
2022-01-09 04:46:51   Cache: 2 / 3
2022-01-09 04:55:59   Epoch[04](2/3): current batch triplet loss = 0.0952, average epoch triplet loss = 0.0958
2022-01-09 04:55:59   Finished epoch 04 in 0:26:05, average epoch triplet loss = 0.0958
2022-01-09 04:55:59   Extracting database features for evaluation/testing
2022-01-09 04:58:52   Extracting queries features for evaluation/testing
2022-01-09 05:01:09   Calculating recalls
2022-01-09 05:01:27   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 47.2, R@5: 68.4, R@10: 75.9, R@20: 83.2
2022-01-09 05:01:27   Not improved: 2 / 3: best R@5 = 74.3, current R@5 = 68.4
2022-01-09 05:01:27   Start training epoch: 05
2022-01-09 05:01:27   Cache: 0 / 3
2022-01-09 05:09:54   Epoch[05](0/3): current batch triplet loss = 0.0956, average epoch triplet loss = 0.0954
2022-01-09 05:09:54   Cache: 1 / 3
2022-01-09 05:18:20   Epoch[05](1/3): current batch triplet loss = 0.0969, average epoch triplet loss = 0.0953
2022-01-09 05:18:20   Cache: 2 / 3
2022-01-09 05:26:42   Epoch[05](2/3): current batch triplet loss = 0.0957, average epoch triplet loss = 0.0951
2022-01-09 05:26:42   Finished epoch 05 in 0:25:14, average epoch triplet loss = 0.0951
2022-01-09 05:26:42   Extracting database features for evaluation/testing
2022-01-09 05:29:14   Extracting queries features for evaluation/testing
2022-01-09 05:31:15   Calculating recalls
2022-01-09 05:31:34   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 54.1, R@5: 74.5, R@10: 81.2, R@20: 86.9
2022-01-09 05:31:34   Improved: previous best R@5 = 74.3, current R@5 = 74.5
2022-01-09 05:31:34   Start training epoch: 06
2022-01-09 05:31:34   Cache: 0 / 3
2022-01-09 05:40:04   Epoch[06](0/3): current batch triplet loss = 0.0973, average epoch triplet loss = 0.0949
2022-01-09 05:40:04   Cache: 1 / 3
2022-01-09 05:48:30   Epoch[06](1/3): current batch triplet loss = 0.0979, average epoch triplet loss = 0.0942
2022-01-09 05:48:30   Cache: 2 / 3
2022-01-09 05:56:54   Epoch[06](2/3): current batch triplet loss = 0.0908, average epoch triplet loss = 0.0943
2022-01-09 05:56:54   Finished epoch 06 in 0:25:19, average epoch triplet loss = 0.0943
2022-01-09 05:56:54   Extracting database features for evaluation/testing
2022-01-09 05:59:28   Extracting queries features for evaluation/testing
2022-01-09 06:01:32   Calculating recalls
2022-01-09 06:01:50   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 49.5, R@5: 70.3, R@10: 78.1, R@20: 84.7
2022-01-09 06:01:50   Not improved: 1 / 3: best R@5 = 74.5, current R@5 = 70.3
2022-01-09 06:01:50   Start training epoch: 07
2022-01-09 06:01:50   Cache: 0 / 3
2022-01-09 06:10:17   Epoch[07](0/3): current batch triplet loss = 0.1116, average epoch triplet loss = 0.0930
2022-01-09 06:10:17   Cache: 1 / 3
2022-01-09 06:18:39   Epoch[07](1/3): current batch triplet loss = 0.0971, average epoch triplet loss = 0.0929
2022-01-09 06:18:39   Cache: 2 / 3
2022-01-09 06:27:01   Epoch[07](2/3): current batch triplet loss = 0.0978, average epoch triplet loss = 0.0935
2022-01-09 06:27:01   Finished epoch 07 in 0:25:10, average epoch triplet loss = 0.0935
2022-01-09 06:27:01   Extracting database features for evaluation/testing
2022-01-09 06:29:32   Extracting queries features for evaluation/testing
2022-01-09 06:31:33   Calculating recalls
2022-01-09 06:31:52   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 40.9, R@5: 60.4, R@10: 68.2, R@20: 76.3
2022-01-09 06:31:52   Not improved: 2 / 3: best R@5 = 74.5, current R@5 = 60.4
2022-01-09 06:31:52   Start training epoch: 08
2022-01-09 06:31:52   Cache: 0 / 3
2022-01-09 06:40:22   Epoch[08](0/3): current batch triplet loss = 0.0917, average epoch triplet loss = 0.0915
2022-01-09 06:40:22   Cache: 1 / 3
2022-01-09 06:48:45   Epoch[08](1/3): current batch triplet loss = 0.0937, average epoch triplet loss = 0.0920
2022-01-09 06:48:45   Cache: 2 / 3
2022-01-09 06:57:13   Epoch[08](2/3): current batch triplet loss = 0.0453, average epoch triplet loss = 0.0912
2022-01-09 06:57:13   Finished epoch 08 in 0:25:21, average epoch triplet loss = 0.0912
2022-01-09 06:57:13   Extracting database features for evaluation/testing
2022-01-09 06:59:48   Extracting queries features for evaluation/testing
2022-01-09 07:01:52   Calculating recalls
2022-01-09 07:02:12   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 37.5, R@5: 57.3, R@10: 65.8, R@20: 74.2
2022-01-09 07:02:12   Not improved: 3 / 3: best R@5 = 74.5, current R@5 = 57.3
2022-01-09 07:02:12   Performance did not improve for 3 epochs. Stop training.
2022-01-09 07:02:12   Best R@5: 74.5
2022-01-09 07:02:12   Trained for 09 epochs, in total in 4:34:19
2022-01-09 07:02:12   Extracting database features for evaluation/testing
2022-01-09 07:05:09   Extracting queries features for evaluation/testing
2022-01-09 07:07:15   Calculating recalls
2022-01-09 07:07:32   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 51.7, R@5: 72.9, R@10: 81.0, R@20: 87.6
