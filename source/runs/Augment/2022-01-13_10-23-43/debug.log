2022-01-13 10:23:43   Arguments: Namespace(augment_data=3, cache_refresh_rate=1000, datasets_folder='../data/', device='cuda', epochs_num=20, exp_name='./runs/augment', gem_power=None, infer_batch_size=16, lr=1e-06, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, optimizer='Adam', output_folder='runs\\./runs/augment\\2022-01-13_10-23-43', patience=3, queries_per_epoch=3000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=2, train_positives_dist_threshold=10, val_positive_dist_threshold=25)
2022-01-13 10:23:43   The outputs are being saved in runs\./runs/augment\2022-01-13_10-23-43
2022-01-13 10:23:43   Using 1 GPUs and 8 CPUs
2022-01-13 10:23:43   Loading dataset Pitts30k from folder ../data/
2022-01-13 10:23:44   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-13 10:23:44   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-13 10:23:44   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-13 10:23:45   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-13 10:23:45   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-13 10:23:46   Output dimension of the model is 16384
2022-01-13 10:23:46   Start training epoch: 00
2022-01-13 10:23:46   Cache: 0 / 3
2022-01-13 10:34:14   Epoch[00](0/3): current batch triplet loss = 0.0689, average epoch triplet loss = 0.0868
2022-01-13 10:34:14   Cache: 1 / 3
2022-01-13 10:44:58   Epoch[00](1/3): current batch triplet loss = 0.1009, average epoch triplet loss = 0.0875
2022-01-13 10:44:58   Cache: 2 / 3
2022-01-13 10:55:44   Epoch[00](2/3): current batch triplet loss = 0.0893, average epoch triplet loss = 0.0870
2022-01-13 10:55:44   Finished epoch 00 in 0:31:58, average epoch triplet loss = 0.0870
2022-01-13 10:55:44   Extracting database features for evaluation/testing
2022-01-13 10:58:35   Extracting queries features for evaluation/testing
2022-01-13 11:00:48   Calculating recalls
2022-01-13 11:01:24   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 55.4, R@5: 72.9, R@10: 80.1, R@20: 86.0
2022-01-13 11:01:25   Improved: previous best R@5 = 0.0, current R@5 = 72.9
2022-01-13 11:01:25   Start training epoch: 01
2022-01-13 11:01:25   Cache: 0 / 3
2022-01-13 11:12:19   Epoch[01](0/3): current batch triplet loss = 0.0973, average epoch triplet loss = 0.0853
2022-01-13 11:12:19   Cache: 1 / 3
2022-01-13 11:23:12   Epoch[01](1/3): current batch triplet loss = 0.0889, average epoch triplet loss = 0.0854
2022-01-13 11:23:12   Cache: 2 / 3
2022-01-13 11:34:01   Epoch[01](2/3): current batch triplet loss = 0.0969, average epoch triplet loss = 0.0849
2022-01-13 11:34:01   Finished epoch 01 in 0:32:36, average epoch triplet loss = 0.0849
2022-01-13 11:34:01   Extracting database features for evaluation/testing
2022-01-13 11:36:27   Extracting queries features for evaluation/testing
2022-01-13 11:38:27   Calculating recalls
2022-01-13 11:39:03   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 63.4, R@5: 80.5, R@10: 86.6, R@20: 90.6
2022-01-13 11:39:04   Improved: previous best R@5 = 72.9, current R@5 = 80.5
2022-01-13 11:39:04   Start training epoch: 02
2022-01-13 11:39:04   Cache: 0 / 3
2022-01-13 11:49:47   Epoch[02](0/3): current batch triplet loss = 0.0994, average epoch triplet loss = 0.0847
2022-01-13 11:49:47   Cache: 1 / 3
2022-01-13 12:00:39   Epoch[02](1/3): current batch triplet loss = 0.0934, average epoch triplet loss = 0.0842
2022-01-13 12:00:39   Cache: 2 / 3
2022-01-13 12:11:32   Epoch[02](2/3): current batch triplet loss = 0.0807, average epoch triplet loss = 0.0841
2022-01-13 12:11:32   Finished epoch 02 in 0:32:28, average epoch triplet loss = 0.0841
2022-01-13 12:11:32   Extracting database features for evaluation/testing
2022-01-13 12:14:00   Extracting queries features for evaluation/testing
2022-01-13 12:16:04   Calculating recalls
2022-01-13 12:16:41   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 68.2, R@5: 84.4, R@10: 89.2, R@20: 92.7
2022-01-13 12:16:41   Improved: previous best R@5 = 80.5, current R@5 = 84.4
2022-01-13 12:16:41   Start training epoch: 03
2022-01-13 12:16:41   Cache: 0 / 3
2022-01-13 12:27:14   Epoch[03](0/3): current batch triplet loss = 0.0897, average epoch triplet loss = 0.0839
2022-01-13 12:27:14   Cache: 1 / 3
2022-01-13 12:38:11   Epoch[03](1/3): current batch triplet loss = 0.0881, average epoch triplet loss = 0.0838
2022-01-13 12:38:11   Cache: 2 / 3
2022-01-13 12:48:55   Epoch[03](2/3): current batch triplet loss = 0.0972, average epoch triplet loss = 0.0838
2022-01-13 12:48:55   Finished epoch 03 in 0:32:13, average epoch triplet loss = 0.0838
2022-01-13 12:48:55   Extracting database features for evaluation/testing
2022-01-13 12:51:13   Extracting queries features for evaluation/testing
2022-01-13 12:53:01   Calculating recalls
2022-01-13 12:53:32   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 72.6, R@5: 87.2, R@10: 91.3, R@20: 94.4
2022-01-13 12:53:32   Improved: previous best R@5 = 84.4, current R@5 = 87.2
2022-01-13 12:53:32   Start training epoch: 04
2022-01-13 12:53:32   Cache: 0 / 3
2022-01-13 13:03:55   Epoch[04](0/3): current batch triplet loss = 0.0469, average epoch triplet loss = 0.0829
2022-01-13 13:03:55   Cache: 1 / 3
2022-01-13 13:14:25   Epoch[04](1/3): current batch triplet loss = 0.0458, average epoch triplet loss = 0.0823
2022-01-13 13:14:25   Cache: 2 / 3
2022-01-13 13:24:47   Epoch[04](2/3): current batch triplet loss = 0.0754, average epoch triplet loss = 0.0825
2022-01-13 13:24:47   Finished epoch 04 in 0:31:15, average epoch triplet loss = 0.0825
2022-01-13 13:24:47   Extracting database features for evaluation/testing
2022-01-13 13:27:05   Extracting queries features for evaluation/testing
2022-01-13 13:28:54   Calculating recalls
2022-01-13 13:29:23   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 74.2, R@5: 88.2, R@10: 92.0, R@20: 94.9
2022-01-13 13:29:24   Improved: previous best R@5 = 87.2, current R@5 = 88.2
2022-01-13 13:29:24   Start training epoch: 05
2022-01-13 13:29:24   Cache: 0 / 3
2022-01-13 13:39:49   Epoch[05](0/3): current batch triplet loss = 0.0841, average epoch triplet loss = 0.0809
2022-01-13 13:39:49   Cache: 1 / 3
2022-01-13 13:50:13   Epoch[05](1/3): current batch triplet loss = 0.0841, average epoch triplet loss = 0.0815
2022-01-13 13:50:13   Cache: 2 / 3
2022-01-13 14:00:38   Epoch[05](2/3): current batch triplet loss = 0.0415, average epoch triplet loss = 0.0818
2022-01-13 14:00:38   Finished epoch 05 in 0:31:14, average epoch triplet loss = 0.0818
2022-01-13 14:00:38   Extracting database features for evaluation/testing
2022-01-13 14:02:56   Extracting queries features for evaluation/testing
2022-01-13 14:04:45   Calculating recalls
2022-01-13 14:05:16   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 75.3, R@5: 89.1, R@10: 92.5, R@20: 95.2
2022-01-13 14:05:16   Improved: previous best R@5 = 88.2, current R@5 = 89.1
2022-01-13 14:05:16   Start training epoch: 06
2022-01-13 14:05:16   Cache: 0 / 3
2022-01-13 14:15:40   Epoch[06](0/3): current batch triplet loss = 0.1024, average epoch triplet loss = 0.0817
2022-01-13 14:15:40   Cache: 1 / 3
2022-01-13 14:26:06   Epoch[06](1/3): current batch triplet loss = 0.1016, average epoch triplet loss = 0.0817
2022-01-13 14:26:06   Cache: 2 / 3
2022-01-13 14:36:43   Epoch[06](2/3): current batch triplet loss = 0.0778, average epoch triplet loss = 0.0819
2022-01-13 14:36:43   Finished epoch 06 in 0:31:27, average epoch triplet loss = 0.0819
2022-01-13 14:36:43   Extracting database features for evaluation/testing
2022-01-13 14:39:14   Extracting queries features for evaluation/testing
2022-01-13 14:41:16   Calculating recalls
2022-01-13 14:41:47   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 77.2, R@5: 90.0, R@10: 93.2, R@20: 95.7
2022-01-13 14:41:48   Improved: previous best R@5 = 89.1, current R@5 = 90.0
2022-01-13 14:41:48   Start training epoch: 07
2022-01-13 14:41:48   Cache: 0 / 3
2022-01-13 14:52:10   Epoch[07](0/3): current batch triplet loss = 0.0978, average epoch triplet loss = 0.0800
2022-01-13 14:52:10   Cache: 1 / 3
2022-01-13 15:02:34   Epoch[07](1/3): current batch triplet loss = 0.0835, average epoch triplet loss = 0.0807
2022-01-13 15:02:34   Cache: 2 / 3
2022-01-13 15:12:57   Epoch[07](2/3): current batch triplet loss = 0.0744, average epoch triplet loss = 0.0807
2022-01-13 15:12:57   Finished epoch 07 in 0:31:09, average epoch triplet loss = 0.0807
2022-01-13 15:12:57   Extracting database features for evaluation/testing
2022-01-13 15:15:14   Extracting queries features for evaluation/testing
2022-01-13 15:17:03   Calculating recalls
2022-01-13 15:17:34   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 77.9, R@5: 90.4, R@10: 93.4, R@20: 96.0
2022-01-13 15:17:34   Improved: previous best R@5 = 90.0, current R@5 = 90.4
2022-01-13 15:17:34   Start training epoch: 08
2022-01-13 15:17:34   Cache: 0 / 3
2022-01-13 15:28:05   Epoch[08](0/3): current batch triplet loss = 0.0920, average epoch triplet loss = 0.0805
2022-01-13 15:28:05   Cache: 1 / 3
2022-01-13 15:38:58   Epoch[08](1/3): current batch triplet loss = 0.0554, average epoch triplet loss = 0.0805
2022-01-13 15:38:58   Cache: 2 / 3
2022-01-13 15:49:23   Epoch[08](2/3): current batch triplet loss = 0.0517, average epoch triplet loss = 0.0802
2022-01-13 15:49:23   Finished epoch 08 in 0:31:48, average epoch triplet loss = 0.0802
2022-01-13 15:49:23   Extracting database features for evaluation/testing
2022-01-13 15:51:40   Extracting queries features for evaluation/testing
2022-01-13 15:53:28   Calculating recalls
2022-01-13 15:53:59   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 78.3, R@5: 90.5, R@10: 93.5, R@20: 96.1
2022-01-13 15:53:59   Improved: previous best R@5 = 90.4, current R@5 = 90.5
2022-01-13 15:53:59   Start training epoch: 09
2022-01-13 15:53:59   Cache: 0 / 3
2022-01-13 16:04:27   Epoch[09](0/3): current batch triplet loss = 0.0751, average epoch triplet loss = 0.0799
2022-01-13 16:04:27   Cache: 1 / 3
2022-01-13 16:14:49   Epoch[09](1/3): current batch triplet loss = 0.0269, average epoch triplet loss = 0.0795
2022-01-13 16:14:49   Cache: 2 / 3
2022-01-13 16:25:10   Epoch[09](2/3): current batch triplet loss = 0.0658, average epoch triplet loss = 0.0796
2022-01-13 16:25:10   Finished epoch 09 in 0:31:11, average epoch triplet loss = 0.0796
2022-01-13 16:25:10   Extracting database features for evaluation/testing
2022-01-13 16:27:27   Extracting queries features for evaluation/testing
2022-01-13 16:29:16   Calculating recalls
2022-01-13 16:29:47   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 78.7, R@5: 90.9, R@10: 94.0, R@20: 96.1
2022-01-13 16:29:47   Improved: previous best R@5 = 90.5, current R@5 = 90.9
2022-01-13 16:29:47   Start training epoch: 10
2022-01-13 16:29:47   Cache: 0 / 3
2022-01-13 16:40:09   Epoch[10](0/3): current batch triplet loss = 0.0876, average epoch triplet loss = 0.0797
2022-01-13 16:40:09   Cache: 1 / 3
2022-01-13 16:50:30   Epoch[10](1/3): current batch triplet loss = 0.0809, average epoch triplet loss = 0.0792
2022-01-13 16:50:30   Cache: 2 / 3
2022-01-13 17:00:51   Epoch[10](2/3): current batch triplet loss = 0.0437, average epoch triplet loss = 0.0787
2022-01-13 17:00:51   Finished epoch 10 in 0:31:04, average epoch triplet loss = 0.0787
2022-01-13 17:00:51   Extracting database features for evaluation/testing
2022-01-13 17:03:09   Extracting queries features for evaluation/testing
2022-01-13 17:04:57   Calculating recalls
2022-01-13 17:05:28   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.4, R@5: 91.3, R@10: 94.0, R@20: 96.2
2022-01-13 17:05:28   Improved: previous best R@5 = 90.9, current R@5 = 91.3
2022-01-13 17:05:28   Start training epoch: 11
2022-01-13 17:05:28   Cache: 0 / 3
2022-01-13 17:15:50   Epoch[11](0/3): current batch triplet loss = 0.1033, average epoch triplet loss = 0.0797
2022-01-13 17:15:50   Cache: 1 / 3
2022-01-13 17:26:10   Epoch[11](1/3): current batch triplet loss = 0.0703, average epoch triplet loss = 0.0792
2022-01-13 17:26:10   Cache: 2 / 3
2022-01-13 17:36:32   Epoch[11](2/3): current batch triplet loss = 0.0840, average epoch triplet loss = 0.0793
2022-01-13 17:36:32   Finished epoch 11 in 0:31:04, average epoch triplet loss = 0.0793
2022-01-13 17:36:32   Extracting database features for evaluation/testing
2022-01-13 17:38:49   Extracting queries features for evaluation/testing
2022-01-13 17:40:38   Calculating recalls
2022-01-13 17:41:08   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.4, R@5: 91.4, R@10: 94.3, R@20: 96.2
2022-01-13 17:41:09   Improved: previous best R@5 = 91.3, current R@5 = 91.4
2022-01-13 17:41:09   Start training epoch: 12
2022-01-13 17:41:09   Cache: 0 / 3
2022-01-13 17:51:32   Epoch[12](0/3): current batch triplet loss = 0.0815, average epoch triplet loss = 0.0760
2022-01-13 17:51:32   Cache: 1 / 3
2022-01-13 18:01:54   Epoch[12](1/3): current batch triplet loss = 0.0874, average epoch triplet loss = 0.0769
2022-01-13 18:01:54   Cache: 2 / 3
2022-01-13 18:12:14   Epoch[12](2/3): current batch triplet loss = 0.0766, average epoch triplet loss = 0.0778
2022-01-13 18:12:14   Finished epoch 12 in 0:31:05, average epoch triplet loss = 0.0778
2022-01-13 18:12:14   Extracting database features for evaluation/testing
2022-01-13 18:14:31   Extracting queries features for evaluation/testing
2022-01-13 18:16:20   Calculating recalls
2022-01-13 18:16:51   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.3, R@5: 91.8, R@10: 94.4, R@20: 96.3
2022-01-13 18:16:51   Improved: previous best R@5 = 91.4, current R@5 = 91.8
2022-01-13 18:16:51   Start training epoch: 13
2022-01-13 18:16:51   Cache: 0 / 3
2022-01-13 18:27:11   Epoch[13](0/3): current batch triplet loss = 0.0671, average epoch triplet loss = 0.0776
2022-01-13 18:27:11   Cache: 1 / 3
2022-01-13 18:37:34   Epoch[13](1/3): current batch triplet loss = 0.0804, average epoch triplet loss = 0.0779
2022-01-13 18:37:34   Cache: 2 / 3
2022-01-13 18:47:56   Epoch[13](2/3): current batch triplet loss = 0.0864, average epoch triplet loss = 0.0777
2022-01-13 18:47:56   Finished epoch 13 in 0:31:05, average epoch triplet loss = 0.0777
2022-01-13 18:47:56   Extracting database features for evaluation/testing
2022-01-13 18:50:13   Extracting queries features for evaluation/testing
2022-01-13 18:52:03   Calculating recalls
2022-01-13 18:52:33   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.8, R@5: 92.2, R@10: 94.8, R@20: 96.5
2022-01-13 18:52:33   Improved: previous best R@5 = 91.8, current R@5 = 92.2
2022-01-13 18:52:33   Start training epoch: 14
2022-01-13 18:52:33   Cache: 0 / 3
2022-01-13 19:02:59   Epoch[14](0/3): current batch triplet loss = 0.0651, average epoch triplet loss = 0.0780
2022-01-13 19:02:59   Cache: 1 / 3
2022-01-13 19:13:23   Epoch[14](1/3): current batch triplet loss = 0.0990, average epoch triplet loss = 0.0770
2022-01-13 19:13:23   Cache: 2 / 3
2022-01-13 19:23:51   Epoch[14](2/3): current batch triplet loss = 0.0644, average epoch triplet loss = 0.0770
2022-01-13 19:23:51   Finished epoch 14 in 0:31:17, average epoch triplet loss = 0.0770
2022-01-13 19:23:51   Extracting database features for evaluation/testing
2022-01-13 19:26:11   Extracting queries features for evaluation/testing
2022-01-13 19:28:01   Calculating recalls
2022-01-13 19:28:32   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.3, R@5: 92.3, R@10: 95.1, R@20: 96.5
2022-01-13 19:28:32   Improved: previous best R@5 = 92.2, current R@5 = 92.3
2022-01-13 19:28:32   Start training epoch: 15
2022-01-13 19:28:32   Cache: 0 / 3
2022-01-13 19:39:00   Epoch[15](0/3): current batch triplet loss = 0.0894, average epoch triplet loss = 0.0774
2022-01-13 19:39:00   Cache: 1 / 3
2022-01-13 19:49:27   Epoch[15](1/3): current batch triplet loss = 0.0615, average epoch triplet loss = 0.0766
2022-01-13 19:49:27   Cache: 2 / 3
2022-01-13 19:59:54   Epoch[15](2/3): current batch triplet loss = 0.0746, average epoch triplet loss = 0.0769
2022-01-13 19:59:54   Finished epoch 15 in 0:31:22, average epoch triplet loss = 0.0769
2022-01-13 19:59:54   Extracting database features for evaluation/testing
2022-01-13 20:02:11   Extracting queries features for evaluation/testing
2022-01-13 20:04:00   Calculating recalls
2022-01-13 20:04:31   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.2, R@5: 92.1, R@10: 94.8, R@20: 96.5
2022-01-13 20:04:31   Not improved: 1 / 3: best R@5 = 92.3, current R@5 = 92.1
2022-01-13 20:04:31   Start training epoch: 16
2022-01-13 20:04:31   Cache: 0 / 3
2022-01-13 20:14:59   Epoch[16](0/3): current batch triplet loss = 0.0655, average epoch triplet loss = 0.0761
2022-01-13 20:14:59   Cache: 1 / 3
2022-01-13 20:25:49   Epoch[16](1/3): current batch triplet loss = 0.0761, average epoch triplet loss = 0.0760
2022-01-13 20:25:49   Cache: 2 / 3
2022-01-13 20:36:23   Epoch[16](2/3): current batch triplet loss = 0.0769, average epoch triplet loss = 0.0758
2022-01-13 20:36:23   Finished epoch 16 in 0:31:51, average epoch triplet loss = 0.0758
2022-01-13 20:36:23   Extracting database features for evaluation/testing
2022-01-13 20:38:41   Extracting queries features for evaluation/testing
2022-01-13 20:40:31   Calculating recalls
2022-01-13 20:41:02   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.2, R@5: 92.1, R@10: 94.7, R@20: 96.5
2022-01-13 20:41:02   Not improved: 2 / 3: best R@5 = 92.3, current R@5 = 92.1
2022-01-13 20:41:02   Start training epoch: 17
2022-01-13 20:41:02   Cache: 0 / 3
2022-01-13 20:51:32   Epoch[17](0/3): current batch triplet loss = 0.1130, average epoch triplet loss = 0.0752
2022-01-13 20:51:32   Cache: 1 / 3
2022-01-13 21:02:25   Epoch[17](1/3): current batch triplet loss = 0.0944, average epoch triplet loss = 0.0749
2022-01-13 21:02:25   Cache: 2 / 3
2022-01-13 21:13:18   Epoch[17](2/3): current batch triplet loss = 0.0738, average epoch triplet loss = 0.0751
2022-01-13 21:13:18   Finished epoch 17 in 0:32:16, average epoch triplet loss = 0.0751
2022-01-13 21:13:18   Extracting database features for evaluation/testing
2022-01-13 21:15:44   Extracting queries features for evaluation/testing
2022-01-13 21:17:42   Calculating recalls
2022-01-13 21:18:18   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.4, R@5: 92.3, R@10: 94.8, R@20: 96.5
2022-01-13 21:18:18   Not improved: 3 / 3: best R@5 = 92.3, current R@5 = 92.3
2022-01-13 21:18:18   Performance did not improve for 3 epochs. Stop training.
2022-01-13 21:18:18   Best R@5: 92.3
2022-01-13 21:18:18   Trained for 18 epochs, in total in 10:54:35
2022-01-13 21:18:19   Extracting database features for evaluation/testing
2022-01-13 21:21:13   Extracting queries features for evaluation/testing
2022-01-13 21:23:14   Calculating recalls
2022-01-13 21:23:43   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 80.1, R@5: 90.6, R@10: 93.4, R@20: 95.5
