2022-01-05 14:34:30   Arguments: Namespace(cache_refresh_rate=1000, datasets_folder='Drop-Geo/dataset/', device='cuda', epochs_num=20, exp_name='Drop-Geo/source/runs/NetVlad_sdg', gem_power=None, infer_batch_size=16, lr=1e-05, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=16, num_workers=4, optimizer='SDG', output_folder='runs/Drop-Geo/source/runs/NetVlad_sdg/2022-01-05_14-34-30', patience=3, queries_per_epoch=3000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=2, train_positives_dist_threshold=10, val_positive_dist_threshold=25)
2022-01-05 14:34:30   The outputs are being saved in runs/Drop-Geo/source/runs/NetVlad_sdg/2022-01-05_14-34-30
2022-01-05 14:34:30   Using 1 GPUs and 2 CPUs
2022-01-05 14:34:30   Loading dataset Pitts30k from folder Drop-Geo/dataset/
2022-01-05 14:34:30   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-05 14:34:30   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-05 14:34:30   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-05 14:34:31   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-05 14:34:31   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-05 14:34:33   Output dimension of the model is 4096
2022-01-05 14:34:33   Start training epoch: 00
2022-01-05 14:34:33   Cache: 0 / 3
2022-01-05 14:43:11   Epoch[00](0/3): current batch triplet loss = 0.0932, average epoch triplet loss = 0.0980
2022-01-05 14:43:11   Cache: 1 / 3
2022-01-05 14:51:48   Epoch[00](1/3): current batch triplet loss = 0.1028, average epoch triplet loss = 0.0983
2022-01-05 14:51:48   Cache: 2 / 3
2022-01-05 15:00:26   Epoch[00](2/3): current batch triplet loss = 0.0998, average epoch triplet loss = 0.0985
2022-01-05 15:00:26   Finished epoch 00 in 0:25:52, average epoch triplet loss = 0.0985
2022-01-05 15:00:26   Extracting database features for evaluation/testing
2022-01-05 15:03:16   Extracting queries features for evaluation/testing
2022-01-05 15:05:25   Calculating recalls
2022-01-05 15:05:37   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 24.6, R@5: 39.7, R@10: 47.1, R@20: 56.2
2022-01-05 15:05:37   Improved: previous best R@5 = 0.0, current R@5 = 39.7
2022-01-05 15:05:37   Start training epoch: 01
2022-01-05 15:05:37   Cache: 0 / 3
2022-01-05 15:14:21   Epoch[01](0/3): current batch triplet loss = 0.1011, average epoch triplet loss = 0.0990
2022-01-05 15:14:21   Cache: 1 / 3
2022-01-05 15:23:03   Epoch[01](1/3): current batch triplet loss = 0.0991, average epoch triplet loss = 0.0989
2022-01-05 15:23:03   Cache: 2 / 3
2022-01-05 15:31:45   Epoch[01](2/3): current batch triplet loss = 0.1025, average epoch triplet loss = 0.0989
2022-01-05 15:31:45   Finished epoch 01 in 0:26:08, average epoch triplet loss = 0.0989
2022-01-05 15:31:45   Extracting database features for evaluation/testing
2022-01-05 15:34:35   Extracting queries features for evaluation/testing
2022-01-05 15:36:45   Calculating recalls
2022-01-05 15:36:57   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 22.8, R@5: 36.6, R@10: 44.4, R@20: 53.1
2022-01-05 15:36:57   Not improved: 1 / 3: best R@5 = 39.7, current R@5 = 36.6
2022-01-05 15:36:57   Start training epoch: 02
2022-01-05 15:36:57   Cache: 0 / 3
2022-01-05 15:45:39   Epoch[02](0/3): current batch triplet loss = 0.1003, average epoch triplet loss = 0.0991
2022-01-05 15:45:39   Cache: 1 / 3
2022-01-05 15:54:20   Epoch[02](1/3): current batch triplet loss = 0.1008, average epoch triplet loss = 0.0991
2022-01-05 15:54:20   Cache: 2 / 3
2022-01-05 16:03:03   Epoch[02](2/3): current batch triplet loss = 0.0995, average epoch triplet loss = 0.0992
2022-01-05 16:03:03   Finished epoch 02 in 0:26:06, average epoch triplet loss = 0.0992
2022-01-05 16:03:03   Extracting database features for evaluation/testing
2022-01-05 16:05:53   Extracting queries features for evaluation/testing
2022-01-05 16:08:03   Calculating recalls
2022-01-05 16:08:15   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 23.0, R@5: 37.4, R@10: 44.9, R@20: 53.8
2022-01-05 16:08:15   Not improved: 2 / 3: best R@5 = 39.7, current R@5 = 37.4
2022-01-05 16:08:15   Start training epoch: 03
2022-01-05 16:08:15   Cache: 0 / 3
2022-01-05 16:16:57   Epoch[03](0/3): current batch triplet loss = 0.1014, average epoch triplet loss = 0.0994
2022-01-05 16:16:57   Cache: 1 / 3
2022-01-05 16:25:39   Epoch[03](1/3): current batch triplet loss = 0.0990, average epoch triplet loss = 0.0993
2022-01-05 16:25:39   Cache: 2 / 3
2022-01-05 16:34:22   Epoch[03](2/3): current batch triplet loss = 0.1015, average epoch triplet loss = 0.0994
2022-01-05 16:34:22   Finished epoch 03 in 0:26:07, average epoch triplet loss = 0.0994
2022-01-05 16:34:22   Extracting database features for evaluation/testing
2022-01-05 16:37:12   Extracting queries features for evaluation/testing
2022-01-05 16:39:22   Calculating recalls
2022-01-05 16:39:33   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 24.3, R@5: 39.6, R@10: 47.0, R@20: 56.1
2022-01-05 16:39:33   Not improved: 3 / 3: best R@5 = 39.7, current R@5 = 39.6
2022-01-05 16:39:33   Performance did not improve for 3 epochs. Stop training.
2022-01-05 16:39:33   Best R@5: 39.7
2022-01-05 16:39:33   Trained for 04 epochs, in total in 2:05:03
2022-01-05 16:39:34   Extracting database features for evaluation/testing
2022-01-05 16:42:24   Extracting queries features for evaluation/testing
2022-01-05 16:44:20   Calculating recalls
2022-01-05 16:44:31   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 30.7, R@5: 49.6, R@10: 60.8, R@20: 72.3
