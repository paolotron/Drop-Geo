2021-12-30 18:12:18   Arguments: Namespace(cache_refresh_rate=1000, datasets_folder='../data/', device='cuda', epochs_num=10, exp_name='./GeM', gem_power=3.0, infer_batch_size=16, lr=1e-05, margin=0.1, neg_samples_num=1000, negs_num_per_query=5, netvlad_clusters=None, num_workers=8, output_folder='runs/./GeM/2021-12-30_18-12-18', patience=3, queries_per_epoch=3000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, val_positive_dist_threshold=25)
2021-12-30 18:12:18   The outputs are being saved in runs/./GeM/2021-12-30_18-12-18
2021-12-30 18:12:18   Using 1 GPUs and 8 CPUs
2021-12-30 18:12:18   Loading dataset Pitts30k from folder ../data/
2021-12-30 18:12:18   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2021-12-30 18:12:18   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2021-12-30 18:12:19   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2021-12-30 18:12:19   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2021-12-30 18:12:19   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2021-12-30 18:12:21   Output dimension of the model is 256
2021-12-30 18:12:21   Start training epoch: 00
2021-12-30 18:12:21   Cache: 0 / 3
2021-12-30 18:18:04   Epoch[00](0/3): current batch triplet loss = 0.0612, average epoch triplet loss = 0.0745
2021-12-30 18:18:04   Cache: 1 / 3
2021-12-30 18:23:49   Epoch[00](1/3): current batch triplet loss = 0.0805, average epoch triplet loss = 0.0706
2021-12-30 18:23:49   Cache: 2 / 3
2021-12-30 18:29:30   Epoch[00](2/3): current batch triplet loss = 0.0569, average epoch triplet loss = 0.0672
2021-12-30 18:29:31   Finished epoch 00 in 0:17:09, average epoch triplet loss = 0.0672
2021-12-30 18:29:31   Extracting database features for evaluation/testing
2021-12-30 18:32:04   Extracting queries features for evaluation/testing
2021-12-30 18:34:00   Calculating recalls
2021-12-30 18:34:04   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 68.2, R@5: 85.0, R@10: 90.5, R@20: 94.2
2021-12-30 18:34:05   Improved: previous best R@5 = 0.0, current R@5 = 85.0
2021-12-30 18:34:05   Start training epoch: 01
2021-12-30 18:34:05   Cache: 0 / 3
2021-12-30 18:39:49   Epoch[01](0/3): current batch triplet loss = 0.0640, average epoch triplet loss = 0.0573
2021-12-30 18:39:49   Cache: 1 / 3
2021-12-30 18:45:31   Epoch[01](1/3): current batch triplet loss = 0.0668, average epoch triplet loss = 0.0569
2021-12-30 18:45:31   Cache: 2 / 3
2021-12-30 18:51:14   Epoch[01](2/3): current batch triplet loss = 0.0793, average epoch triplet loss = 0.0554
2021-12-30 18:51:14   Finished epoch 01 in 0:17:08, average epoch triplet loss = 0.0554
2021-12-30 18:51:14   Extracting database features for evaluation/testing
2021-12-30 18:53:48   Extracting queries features for evaluation/testing
2021-12-30 18:55:45   Calculating recalls
2021-12-30 18:55:48   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 72.9, R@5: 87.8, R@10: 91.9, R@20: 95.0
2021-12-30 18:55:49   Improved: previous best R@5 = 85.0, current R@5 = 87.8
2021-12-30 18:55:49   Start training epoch: 02
2021-12-30 18:55:49   Cache: 0 / 3
2021-12-30 19:01:32   Epoch[02](0/3): current batch triplet loss = 0.0361, average epoch triplet loss = 0.0503
2021-12-30 19:01:32   Cache: 1 / 3
2021-12-30 19:07:17   Epoch[02](1/3): current batch triplet loss = 0.0689, average epoch triplet loss = 0.0493
2021-12-30 19:07:17   Cache: 2 / 3
2021-12-30 19:13:01   Epoch[02](2/3): current batch triplet loss = 0.0487, average epoch triplet loss = 0.0490
2021-12-30 19:13:01   Finished epoch 02 in 0:17:12, average epoch triplet loss = 0.0490
2021-12-30 19:13:01   Extracting database features for evaluation/testing
2021-12-30 19:15:35   Extracting queries features for evaluation/testing
2021-12-30 19:17:33   Calculating recalls
2021-12-30 19:17:35   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 75.3, R@5: 89.4, R@10: 93.2, R@20: 95.8
2021-12-30 19:17:36   Improved: previous best R@5 = 87.8, current R@5 = 89.4
2021-12-30 19:17:36   Start training epoch: 03
2021-12-30 19:17:36   Cache: 0 / 3
2021-12-30 19:23:20   Epoch[03](0/3): current batch triplet loss = 0.0628, average epoch triplet loss = 0.0470
2021-12-30 19:23:20   Cache: 1 / 3
2021-12-30 19:29:03   Epoch[03](1/3): current batch triplet loss = 0.0464, average epoch triplet loss = 0.0450
2021-12-30 19:29:03   Cache: 2 / 3
2021-12-30 19:34:47   Epoch[03](2/3): current batch triplet loss = 0.0236, average epoch triplet loss = 0.0443
2021-12-30 19:34:47   Finished epoch 03 in 0:17:10, average epoch triplet loss = 0.0443
2021-12-30 19:34:47   Extracting database features for evaluation/testing
2021-12-30 19:37:20   Extracting queries features for evaluation/testing
2021-12-30 19:39:17   Calculating recalls
2021-12-30 19:39:18   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 76.8, R@5: 90.2, R@10: 93.8, R@20: 96.0
2021-12-30 19:39:19   Improved: previous best R@5 = 89.4, current R@5 = 90.2
2021-12-30 19:39:19   Start training epoch: 04
2021-12-30 19:39:19   Cache: 0 / 3
2021-12-30 19:45:01   Epoch[04](0/3): current batch triplet loss = 0.0189, average epoch triplet loss = 0.0417
2021-12-30 19:45:01   Cache: 1 / 3
2021-12-30 19:50:43   Epoch[04](1/3): current batch triplet loss = 0.0291, average epoch triplet loss = 0.0399
2021-12-30 19:50:43   Cache: 2 / 3
2021-12-30 19:56:24   Epoch[04](2/3): current batch triplet loss = 0.0196, average epoch triplet loss = 0.0398
2021-12-30 19:56:24   Finished epoch 04 in 0:17:05, average epoch triplet loss = 0.0398
2021-12-30 19:56:24   Extracting database features for evaluation/testing
2021-12-30 19:58:57   Extracting queries features for evaluation/testing
2021-12-30 20:00:54   Calculating recalls
2021-12-30 20:00:55   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 77.8, R@5: 90.9, R@10: 94.0, R@20: 96.4
2021-12-30 20:00:56   Improved: previous best R@5 = 90.2, current R@5 = 90.9
2021-12-30 20:00:56   Start training epoch: 05
2021-12-30 20:00:56   Cache: 0 / 3
2021-12-30 20:06:38   Epoch[05](0/3): current batch triplet loss = 0.0188, average epoch triplet loss = 0.0360
2021-12-30 20:06:38   Cache: 1 / 3
2021-12-30 20:12:19   Epoch[05](1/3): current batch triplet loss = 0.0425, average epoch triplet loss = 0.0368
2021-12-30 20:12:19   Cache: 2 / 3
2021-12-30 20:18:00   Epoch[05](2/3): current batch triplet loss = 0.0425, average epoch triplet loss = 0.0369
2021-12-30 20:18:00   Finished epoch 05 in 0:17:04, average epoch triplet loss = 0.0369
2021-12-30 20:18:01   Extracting database features for evaluation/testing
2021-12-30 20:20:33   Extracting queries features for evaluation/testing
2021-12-30 20:22:29   Calculating recalls
2021-12-30 20:22:30   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 78.2, R@5: 91.3, R@10: 94.2, R@20: 96.3
2021-12-30 20:22:30   Improved: previous best R@5 = 90.9, current R@5 = 91.3
2021-12-30 20:22:30   Start training epoch: 06
2021-12-30 20:22:30   Cache: 0 / 3
2021-12-30 20:28:11   Epoch[06](0/3): current batch triplet loss = 0.0851, average epoch triplet loss = 0.0354
2021-12-30 20:28:12   Cache: 1 / 3
2021-12-30 20:33:54   Epoch[06](1/3): current batch triplet loss = 0.0332, average epoch triplet loss = 0.0358
2021-12-30 20:33:54   Cache: 2 / 3
2021-12-30 20:39:36   Epoch[06](2/3): current batch triplet loss = 0.0021, average epoch triplet loss = 0.0351
2021-12-30 20:39:36   Finished epoch 06 in 0:17:05, average epoch triplet loss = 0.0351
2021-12-30 20:39:36   Extracting database features for evaluation/testing
2021-12-30 20:42:09   Extracting queries features for evaluation/testing
2021-12-30 20:44:05   Calculating recalls
2021-12-30 20:44:06   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 78.8, R@5: 91.4, R@10: 94.5, R@20: 96.5
2021-12-30 20:44:07   Improved: previous best R@5 = 91.3, current R@5 = 91.4
2021-12-30 20:44:07   Start training epoch: 07
2021-12-30 20:44:07   Cache: 0 / 3
2021-12-30 20:49:49   Epoch[07](0/3): current batch triplet loss = 0.0440, average epoch triplet loss = 0.0315
2021-12-30 20:49:49   Cache: 1 / 3
2021-12-30 20:55:30   Epoch[07](1/3): current batch triplet loss = 0.0456, average epoch triplet loss = 0.0327
2021-12-30 20:55:30   Cache: 2 / 3
2021-12-30 21:01:12   Epoch[07](2/3): current batch triplet loss = 0.0331, average epoch triplet loss = 0.0333
2021-12-30 21:01:12   Finished epoch 07 in 0:17:05, average epoch triplet loss = 0.0333
2021-12-30 21:01:13   Extracting database features for evaluation/testing
2021-12-30 21:03:45   Extracting queries features for evaluation/testing
2021-12-30 21:05:42   Calculating recalls
2021-12-30 21:05:42   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.1, R@5: 91.8, R@10: 94.5, R@20: 96.8
2021-12-30 21:05:43   Improved: previous best R@5 = 91.4, current R@5 = 91.8
2021-12-30 21:05:43   Start training epoch: 08
2021-12-30 21:05:43   Cache: 0 / 3
2021-12-30 21:11:24   Epoch[08](0/3): current batch triplet loss = 0.0222, average epoch triplet loss = 0.0319
2021-12-30 21:11:24   Cache: 1 / 3
2021-12-30 21:17:06   Epoch[08](1/3): current batch triplet loss = 0.0190, average epoch triplet loss = 0.0324
2021-12-30 21:17:06   Cache: 2 / 3
2021-12-30 21:22:49   Epoch[08](2/3): current batch triplet loss = 0.0359, average epoch triplet loss = 0.0315
2021-12-30 21:22:49   Finished epoch 08 in 0:17:06, average epoch triplet loss = 0.0315
2021-12-30 21:22:50   Extracting database features for evaluation/testing
2021-12-30 21:25:22   Extracting queries features for evaluation/testing
2021-12-30 21:27:18   Calculating recalls
2021-12-30 21:27:19   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.7, R@5: 91.7, R@10: 94.5, R@20: 96.6
2021-12-30 21:27:20   Not improved: 1 / 3: best R@5 = 91.8, current R@5 = 91.7
2021-12-30 21:27:20   Start training epoch: 09
2021-12-30 21:27:20   Cache: 0 / 3
2021-12-30 21:33:01   Epoch[09](0/3): current batch triplet loss = 0.0174, average epoch triplet loss = 0.0312
2021-12-30 21:33:01   Cache: 1 / 3
2021-12-30 21:38:42   Epoch[09](1/3): current batch triplet loss = 0.0098, average epoch triplet loss = 0.0305
2021-12-30 21:38:42   Cache: 2 / 3
2021-12-30 21:44:23   Epoch[09](2/3): current batch triplet loss = 0.0255, average epoch triplet loss = 0.0302
2021-12-30 21:44:23   Finished epoch 09 in 0:17:03, average epoch triplet loss = 0.0302
2021-12-30 21:44:23   Extracting database features for evaluation/testing
2021-12-30 21:46:56   Extracting queries features for evaluation/testing
2021-12-30 21:48:52   Calculating recalls
2021-12-30 21:48:53   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.0, R@5: 91.9, R@10: 94.6, R@20: 96.8
2021-12-30 21:48:53   Improved: previous best R@5 = 91.8, current R@5 = 91.9
2021-12-30 21:48:53   Best R@5: 91.9
2021-12-30 21:48:53   Trained for 10 epochs, in total in 3:36:34
2021-12-30 21:48:55   Extracting database features for evaluation/testing
2021-12-30 21:51:27   Extracting queries features for evaluation/testing
2021-12-30 21:53:11   Calculating recalls
2021-12-30 21:53:12   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 77.2, R@5: 89.8, R@10: 93.0, R@20: 95.1
